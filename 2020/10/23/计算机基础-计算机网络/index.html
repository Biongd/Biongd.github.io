<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="网络," />










<meta name="description" content="在长达一个月左右的颓废生活后，计算机学习又一次有了推进，目前的学习包括了基础，操作系统（linux），数据结构和算法几个部分，好像也忘得差不多了。。赶紧进行网络，数据库和设计模式的学习，早日用项目来夯实基础。">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机网络">
<meta property="og:url" content="http://yoursite.com/2020/10/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/index.html">
<meta property="og:site_name" content="悦来客栈">
<meta property="og:description" content="在长达一个月左右的颓废生活后，计算机学习又一次有了推进，目前的学习包括了基础，操作系统（linux），数据结构和算法几个部分，好像也忘得差不多了。。赶紧进行网络，数据库和设计模式的学习，早日用项目来夯实基础。">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201217135038.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201217133008.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201217133038.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201217133051.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201217133104.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201217133115.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Biongd/img@main/data/20201026153731.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201217133131.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201217133456.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201217133249.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201217133308.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201217133337.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201231104018.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201217133439.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201223110112.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201224103734.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201230100952.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201225102902.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201225103717.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201225105250.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201225144825.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201225145524.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201228193020.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201229101338.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201229103009.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201229104003.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201231100849.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20201231105406.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210206141555.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210206141902.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210206142117.png">
<meta property="og:image" content="c:/Users/biongd/AppData/Roaming/Typora/typora-user-images/image-20210204174436159.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210204175235.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210204175835.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210204184844.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210204190222.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210204220139.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210204213946.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210204214916.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210204221259.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210204223548.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210204225513.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210206122555.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210209002312.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210206154050.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210206161251.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210206162928.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210206163012.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210206163136.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210206163335.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210206162839.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210209121717.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210207180701.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210207180742.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210207183445.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210207200619.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210207200724.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210207201024.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208084434.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208090154.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208090400.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208122706.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208122735.png">
<meta property="og:image" content="https://ewr1.vultrobjects.com/imgspice2/000/006/177/725_959_74a.jpg">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208131738.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208131826.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208214237.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208215617.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208225746.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208230126.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208230228.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208231324.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208231721.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208232156.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208232605.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210208234841.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210209122252.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210209123025.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210209130629.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210209130524.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210416204124.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210416204132.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210416204150.png">
<meta property="article:published_time" content="2020-10-23T02:13:23.000Z">
<meta property="article:modified_time" content="2021-08-29T02:12:48.569Z">
<meta property="article:author" content="xujunjie&#39;blog">
<meta property="article:tag" content="网络">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/biongd/img/raw/master/img/20201217135038.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","display_updated":true,"offset":12,"b2t":true,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/10/23/计算机基础-计算机网络/"/>





  <title>计算机网络 | 悦来客栈</title>
  








<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">悦来客栈</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">learn and better</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/10/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xujunjie'blog">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悦来客栈">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">计算机网络</h1>
        

        <div class="post-meta">
          <span class="post-time">
              
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-10-23T10:13:23+08:00">
                2020-10-23
              </time>
            
            
                <span class="post-updated">
                     &nbsp; | &nbsp; 更新于
                     <time itemprop="dateUpdated" datetime="2021-08-29T10:12:48+08:00" content="2021-08-29">
                          2021-08-29
                     </time>
                 </span>
             

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E6%95%B0%E6%8D%AE%E5%BA%93-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" itemprop="url" rel="index">
                    <span itemprop="name">计算机基础-操作系统.数据库.计算机网络.计算机组成原理.</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>在长达一个月左右的颓废生活后，计算机学习又一次有了推进，目前的学习包括了基础，操作系统（linux），数据结构和算法几个部分，好像也忘得差不多了。。赶紧进行网络，数据库和设计模式的学习，早日用项目来夯实基础。</p>
<a id="more"></a>
<h1 id="带着问题学网络"><a href="#带着问题学网络" class="headerlink" title="带着问题学网络"></a>带着问题学网络</h1><p><strong>1. 请简述TCP\UDP的区别</strong>，<a href="https://blog.csdn.net/qq_36178727/article/details/90346896#52_UDPTCP_67" target="_blank" rel="noopener">为什么UDP有时比TCP更有优势?</a></p>
<p>2.请简单说一下你了解的端口及对应的服务？</p>
<ul>
<li>21：FTP（文件传输协议）</li>
<li>22：SSH</li>
<li>80：HTTP（超文本传输协议）</li>
<li>53：DNS域名服务器</li>
<li>443：HTTPS</li>
<li>1080：SOCKETS</li>
<li>3306 Mysql服务</li>
</ul>
<p>3.GET 和 POST 区别</p>
<p>4.dns使用的协议：UDP</p>
<p>5.幂等（乐观锁和悲观锁）</p>
<p>6.Cookies和session区别</p>
<p>7.TCP粘包和拆包产生的原因及解决策略</p>
<p>8.三次握手和四次挥手</p>
<p>9.TIME_WAIT和CLOSE_WAIT</p>
<p>10.一次完整的HTTP请求过程</p>
<p>11.讲一下长连接</p>
<p>12.TCP如何保证可靠传输？</p>
<p>13.详细介绍http</p>
<p>14.URL和URI的区别</p>
<p>15.HTTPS和HTTP的区别</p>
<p>16.https是如何保证数据传输的安全</p>
<p>17.IP地址分为哪几类？简单说一下各个分类</p>
<p>18.在浏览器中输入网址之后执行会发生什么？</p>
<p>19.简单解释一些ARP协议的工作过程</p>
<h1 id="1-分层的概念"><a href="#1-分层的概念" class="headerlink" title="1. 分层的概念"></a>1. 分层的概念</h1><h2 id="1-1-标准化工作及相关组织"><a href="#1-1-标准化工作及相关组织" class="headerlink" title="1.1 标准化工作及相关组织"></a>1.1 标准化工作及相关组织</h2><h3 id="1-1-1-标准化工作"><a href="#1-1-1-标准化工作" class="headerlink" title="1.1.1 标准化工作"></a>1.1.1 标准化工作</h3><pre class="mermaid">graph LR
A[标准化分类]-->B(法定标准)
B-->D(由权威机构制定的正式的合法的标准OSI)
A-->C(事实标准)
C-->E(某些公司产品在竞争中占据了主流这些产品中的技术和协议就成为标准TCP/IP)</pre>

<h3 id="1-1-2-因特网标准的形式"><a href="#1-1-2-因特网标准的形式" class="headerlink" title="1.1.2 因特网标准的形式"></a>1.1.2 因特网标准的形式</h3><p>RFC：Request For Comments———-因特网标准的形式</p>
<p>RFC上升为因特网正式标准的四个阶段：</p>
<ul>
<li>因特网草案（还不是RFC文档）—&gt;建议标准（形成RFC文档，提交IEFT,IAB审核）—&gt;因特网标准</li>
</ul>
<h3 id="1-1-3-相关组织"><a href="#1-1-3-相关组织" class="headerlink" title="1.1.3 相关组织"></a>1.1.3 相关组织</h3><ul>
<li>国际标准化组织ISO：OSI参考模型，HDLC协议</li>
<li>国际电信联盟ITU：制定通信规则</li>
<li>国际电气电子工程师协会IEEE：IEEE802系列标准，5G</li>
<li>Internet工程师任务组IETF：负责因特网相关标准的制定</li>
</ul>
<h2 id="1-2-性能指标"><a href="#1-2-性能指标" class="headerlink" title="1.2 性能指标"></a>1.2 性能指标</h2><ul>
<li><p>速率：数据率或称数据传输率或比特率</p>
<p>连接在计算机网络上的主机在数字信道上传送数据位数的速率：以每秒传送的bit数作为单位</p>
</li>
<li><p>带宽：区别于模拟信号所指的频带范围</p>
<p>表示网络的通信线路传送数据的能力，通常是指单位时间内从网络中的某一点到另一点所能通过的“最高数据率”，单位和速率单位相同，即网络设备所支持的最高速度。</p>
</li>
<li><p>吞吐量：单位时间内通过某个网络（或信道，接口）的数据量。单位b/s,kb/s.Mb/s。吞吐量受网络的带宽或网络的额定速率限制。</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201217135038.png" alt="性能指标"></p>
</li>
<li><p>时延：指数据（报文/分组/比特流）从网络(或链路)的一端传送到另一端所需的时间。也叫延迟或迟延。单位是s。</p>
</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201217133008.png" alt="image-20201026102945956"></p>
<ul>
<li><p>时延带宽积：传播时延*带宽</p>
<p>即以bit为单位的链路长度，即“某段链路现在有多少bit”</p>
</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201217133038.png" alt="image-20201026103301312"></p>
<ul>
<li><p>往返时延RTT</p>
<p>从发送方发出数据开始，到发送方收到接收方的确认（接收方收到发送后立即发送确认），总共经历的时延。</p>
</li>
<li><p>利用率</p>
<ul>
<li>信道利用率</li>
<li>网络利用率</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201217133051.png" alt="image-20201026104120511"></p>
<h2 id="1-3-分层结构"><a href="#1-3-分层结构" class="headerlink" title="1.3 分层结构"></a>1.3 分层结构</h2><h3 id="1-3-1-为什么要有分层呢"><a href="#1-3-1-为什么要有分层呢" class="headerlink" title="1.3.1 为什么要有分层呢?"></a>1.3.1 为什么要有分层呢?</h3><p>以文件发送为例：为了实现文件在两台电脑间的传输，要完成包括对数据通信的通路进行激活，告诉网络如何识别目的主机，发起通信的计算机要查明目的主机是否开机且与网络连接正常。。。等很多工作。分层结构即是将众多问题拆分解决。</p>
<h3 id="1-3-2-怎么分层及分层基本原则"><a href="#1-3-2-怎么分层及分层基本原则" class="headerlink" title="1.3.2 怎么分层及分层基本原则"></a>1.3.2 怎么分层及分层基本原则</h3><ul>
<li>以一瓶82年拉菲的快递运输为例：</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201217133104.png" alt="image-20201026151727579"></p>
<ul>
<li>正式分层结构</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201217133115.png" alt="QQ图片20201026152512"></p>
<p>如图中所示，第5层的data就是第四层的SDU，通过结合第四层的PCI，得到PDU；然后PDU交由第三层进行服务，作为第三层的SDU，又和第三层的PCI结合。以此类推，各个层次完成各层功能。</p>
<ul>
<li>概念总结</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Biongd/img@main/data/20201026153731.png" alt="image-20201026153731748"></p>
<h2 id="1-4-参考模型"><a href="#1-4-参考模型" class="headerlink" title="1.4 参考模型"></a>1.4 参考模型</h2><h3 id="1-4-1-OSI参考模型"><a href="#1-4-1-OSI参考模型" class="headerlink" title="1.4.1 OSI参考模型"></a>1.4.1 OSI参考模型</h3><pre class="mermaid">graph LR
A[计算机网络分层结构]-->B(7层OSI参考模型)
B-->C(法定标准)
A-->D(4层TCP/IP参考模型)
D-->E(事实标准)
F[5层体系结构]-->G(方便理解和学习)</pre>

<p>国际标准化组织(ISO)于1984年提出开放系统互联(OSI)参考模型。</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201217133131.png" alt="image-20201026160228468" style="zoom:67%;" /></p>
<p>通信过程：中间系统没有上面四层</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201217133456.png" style="zoom: 33%;" /></p>
<h3 id="1-4-2-OSI参考模型各层功能及协议"><a href="#1-4-2-OSI参考模型各层功能及协议" class="headerlink" title="1.4.2 OSI参考模型各层功能及协议"></a>1.4.2 OSI参考模型各层功能及协议</h3><ul>
<li><p>应用层：所有能和用户交互产生网络流量的程序（QQ和邮箱等）</p>
<p>典型应用层服务：文件传输（FTP）;电子邮件（SMTP）;万维网（HTTPs）…</p>
</li>
<li><p>表示层：用于处理在两个通信系统中交换信息的表示方式（语法和语义）</p>
<ul>
<li>功能1：数据格式变换（翻译官）</li>
<li>功能2：数据加密解密</li>
<li>功能3：数据的压缩和恢复</li>
</ul>
</li>
<li><p>会话层：向表示层实体/用户进程提供建立连接并在连接上有序的传输数据。这是会话，也是建立同步（SYN）</p>
<ul>
<li>功能1：建立、管理、终止会话（比如打开的每个应用程序的服务器不会相互影响）</li>
<li>使用校验点可使会话在通信失效时从校验点/同步点继续恢复通信，实现数据同步。（适用于传输大文件）</li>
</ul>
<p>主要协议：ADSP,ASP</p>
</li>
<li><p><a name="传输层">传输层</a>：负责主机中两个进程的通信，即端到端的通信。传输单位是报文段或用户数据报。</p>
<ul>
<li>功能1：可靠传输、不可靠传输</li>
<li>功能2：差错控制</li>
<li>功能3：流量控制</li>
<li>功能4：复用分用</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201217133249.png" alt="image-20201026193853063"></p>
<p>  主要协议：UDP ,TCP</p>
<p>上面四个分层都是指向目的端口，下面3层都是指向下一个要传输的节点（路由器，交换机等）</p>
<ul>
<li><p><a name="网络层">网络层（最重要）</a>：主要任务是把分组从源端传到目的端，为分组交换网上的不同主机提供通信服务。传输单位是数据报（若数据报过长，可划分为更小的单位：分组）<font color="red">数据分组的路由与转发</font></p>
<ul>
<li>功能1：路由选择（选择最佳路径）</li>
<li>功能2：流量控制（收发速度不匹配）</li>
<li>功能3：差错控制（检查收到）</li>
<li>功能4：拥塞控制（若所有节点都来不及接受分组，而要丢弃大量分组的话，网路就处于拥塞状态。因此要采取一定措施，缓解这种拥塞）</li>
<li>功能5：异构网络互联</li>
</ul>
</li>
<li><p>数据链路层：将网络层传下来的数据报组装成帧。数据链路层的传输单位是帧。</p>
<ul>
<li>功能1：成帧（定义帧的开始和结束）开始和结束的二进制序列</li>
<li>功能2：差错控制  帧错+位错</li>
<li>功能3：流量控制</li>
<li>功能4：访问（接入）控制   控制对信道的访问</li>
</ul>
</li>
<li><p>物理层（傻瓜层）：在物理媒介上实现比特流的<font color="red">透明传输</font>。物理层的传输单位是bit。</p>
<p>透明传输：指不管所传数据是什么样的比特组合，都应当能够在链路上传送。</p>
<ul>
<li>功能1：定义接口特性</li>
<li>功能2：定义传输模式 （单工，半双工，双工）</li>
<li>功能3：定义传输速率</li>
<li>功能4：比特同步（时钟）</li>
<li>功能5：比特编码（物理层面）</li>
</ul>
</li>
</ul>
<h2 id="1-5-TCP-IP参考协议"><a href="#1-5-TCP-IP参考协议" class="headerlink" title="1.5 TCP/IP参考协议"></a>1.5 TCP/IP参考协议</h2><p><img src="https://gitee.com/biongd/img/raw/master/img/20201217133308.png" alt="image-20201026200806386"></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201217133337.png" alt="image-20201026201205289"></p>
<h2 id="1-6-各层主要知识点"><a href="#1-6-各层主要知识点" class="headerlink" title="1.6 各层主要知识点"></a>1.6 各层主要知识点</h2><p><img src="https://gitee.com/biongd/img/raw/master/img/20201231104018.png" alt="image-20201231104018784"></p>
<p><a href="#1">1.数据链路层</a></p>
<ul>
<li>以太网帧的格式</li>
<li>MTU的概念</li>
<li>ARP协议（报文格式，查询原理，缓存）</li>
</ul>
<p>2.网络层</p>
<ul>
<li>IP首部格式（16位分片标识，DF不分片标志，MF更多分片标志，13位偏移，8位生存时间TTL，16位的首部检验和等）</li>
<li>IP分片</li>
<li>IP选路（路由表）</li>
<li>ICMP协议（网络层和传输层的联系）（ICMP协议的报文格式，报文的两大类：查询和差错，2种查询报文+5种差错报文）</li>
</ul>
<p>3.传输层</p>
<ul>
<li>UDP协议：特点+首部各个字段</li>
<li>TCP协议：特点+首部字段+可靠机制</li>
<li>TCP连接控制机制: <strong>三次握手，四次挥手</strong>，同时打开，同时关闭，半关闭</li>
<li><a href="#传输层">流量控制机制：滑动窗口机制，慢启动，拥塞避免，快速重传，快速恢复</a></li>
<li>TCP超时重传机制：4个定时器</li>
</ul>
<p>4.应用层</p>
<ul>
<li>dns协议（域名到ip地址的解析）：dns协议的名字空间，dns指针查询（反向查找或逆向解析）基本原理，dns缓存</li>
<li>ftp协议：弱化的掌握以下（活化石），两条连接：控制连接+数据连接，两种工作模式：pasv+port,各种ftp指令和响应码，frp断点续传，匿名ftp</li>
<li>http协议：报文格式：请求报文、响应报文、请求头各种字段、响应头各种字段。http状态码</li>
<li>https协议：https的详细握手过程，摘要算法，数字签名，数字证书的原理和过程</li>
</ul>
<h1 id="2-物理层"><a href="#2-物理层" class="headerlink" title="2. 物理层"></a>2. 物理层</h1><p><strong>物理层就是傻瓜层，专门负责搬运货物，通过定义标准让傻瓜能够来回搬运数据</strong></p>
<h2 id="2-1-概念"><a href="#2-1-概念" class="headerlink" title="2.1 概念"></a>2.1 概念</h2><p><strong>主要任务</strong>：确定与传输媒体接口有关的一些特性（定义标准）</p>
<ul>
<li>机械特性：定义物理连接的特性，规定物理连接时所采用的规格、接口形状、引线数目、引脚数量和排列情况。</li>
<li>电气特性：规定传输二进制位时，线路上信号的电压范围，阻抗匹配，传输速率和距离限制等。</li>
<li>功能特性：指明某条线上出现的某一电平表示何种意义，接口部件的信号线的用途。</li>
<li>规程特性：定义各条物理线路的工作规程和时序关系</li>
</ul>
<p>数据通信基础知识</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201217133439.png" alt="image-20201028202338798" style="zoom:67%;" /></p>
<p><strong>通信双方的交互方式：</strong></p>
<ul>
<li>单工：只有一方通信（发出和接收），只有一条信道</li>
<li>半双工：双方都可通信，但任何一方都不能在同一时刻接收和发送，两条信道</li>
<li>全双工：互通有无</li>
</ul>
<h2 id="2-2-物理层参数"><a href="#2-2-物理层参数" class="headerlink" title="2.2 物理层参数"></a>2.2 物理层参数</h2><ul>
<li><p>码元：以二进制信号为例，信号方波的一个小横条就是二进制码元，横条时间就是码元宽度</p>
</li>
<li><p>速率，波特，带宽</p>
<ul>
<li><p>速率：</p>
<p>(1)码元传输速率：单位时间内数字通信系统所传输的码元个数（即脉冲个数或信号变化的次数），单位是波特（Baud），1波特表示数字通信系统一秒传输一个码元。</p>
<p>(2)信息传输速率：别名<strong>比特率</strong>，单位时间内数字通信系统所传输的二进制数的个数。（以4进制为例：一个码元就对应两个bit）</p>
<p>(1)1秒传输的码元数，(2)1秒传输的bit数！</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201223110112.png" alt="image-20201223110111995"></p>
<h2 id="2-3-传输介质"><a href="#2-3-传输介质" class="headerlink" title="2.3 传输介质"></a>2.3 传输介质</h2><p><img src="https://gitee.com/biongd/img/raw/master/img/20201224103734.png" alt="image-20201224103734465"></p>
<h2 id="2-4-物理层两大设备"><a href="#2-4-物理层两大设备" class="headerlink" title="2.4 物理层两大设备*"></a>2.4 物理层两大设备*</h2><p>中继器：</p>
<ul>
<li>对信号进行再生和还原，对衰减的信号进行放大，保持与原数据相同，延长传输距离</li>
<li>两端的网络部分是网段，不是子网</li>
</ul>
<p>集线器：（多口中继器）</p>
<h1 id="3-链路层（沟通物理层和网络层）（负责mac地址）"><a href="#3-链路层（沟通物理层和网络层）（负责mac地址）" class="headerlink" title="3. 链路层（沟通物理层和网络层）（负责mac地址）"></a>3. 链路层（沟通物理层和网络层）（负责mac地址）</h1><blockquote>
<p>mac地址：用来确定网络设备位置的地址，mac地址用来在网络中唯一标识一个网卡！若有多个网卡，则有多个网络地址！</p>
<p>一个mac地址是6个字节，可用12个16进制数标识</p>
</blockquote>
<h2 id="3-1-基本概念"><a href="#3-1-基本概念" class="headerlink" title="3.1 基本概念"></a>3.1 基本概念</h2><p>以太网帧的格式：</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201230100952.png" alt="image-20201230100951983"></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201225102902.png" alt="image-20201225102902617"></p>
<h2 id="3-2-功能概述"><a href="#3-2-功能概述" class="headerlink" title="3.2 功能概述"></a>3.2 功能概述</h2><p>数据链路层要未雨绸缪，将物理层可能发生的差错都提前准备好，<strong><font color="red" size="4">加强物理层传输原始bit流的功能。</font></strong></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201225103717.png" alt="image-20201225103717124"></p>
<ul>
<li>为网络层提供服务：无确认无连接服务（实时通信，误码率低），有确认无连接服务（目的主机返回确认信号，无返回则重发），有确认面向连接服务（事前建立连接，收到一个帧返回一个确认帧，发送方接收确认帧才继续发）。</li>
<li>链路管理：连接的建立，维持和释放（面向连接的服务）</li>
<li>组装成帧</li>
<li>差错控制（帧错，位错）</li>
</ul>
<h2 id="3-3-组帧"><a href="#3-3-组帧" class="headerlink" title="3.3 组帧"></a><a name="1">3.3 组帧</a></h2><ul>
<li><p>封装成帧（帧的组成即为了包裹网络层数据，MTU即链路层协议规定的可传送数据部分的大小）</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201225105250.png" alt="image-20201225105250515"></p>
</li>
<li><p>透明传输（对于数据的bit组合和控制信息一样时（比如和上图的帧尾部相同，直接结束发送），采取适当措施，保证透明传输）</p>
<ul>
<li>字节计数法</li>
<li>字符填充法（在和控制信号相同的编码前添加一个字节的转译字符）</li>
<li>零bit填充法：收尾帧都是<code>01111110</code>,然后数据部分每5位1后填一个0，接收方每5个1删一个0</li>
<li>违规编码法：<img src="https://gitee.com/biongd/img/raw/master/img/20201225144825.png" alt="在这里插入图片描述"></li>
</ul>
</li>
</ul>
<h2 id="3-4-差错控制"><a href="#3-4-差错控制" class="headerlink" title="3.4 差错控制"></a>3.4 差错控制</h2><p>差错产生原因：电气特性携带的噪声；外界冲击噪声</p>
<p>分类：帧错（链路层为网络层），位错</p>
<p>为何要实现差错控制：发送节点和目的节点间可能有多个节点，如果到了目的节点才发现错误发回重传请求就太晚了。</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201225145524.png" alt="image-20201225145524434"></p>
<h2 id="3-5-流量控制和可靠传输机制"><a href="#3-5-流量控制和可靠传输机制" class="headerlink" title="3.5 流量控制和可靠传输机制*"></a><a name="TCP">3.5 流量控制和可靠传输机制*</a></h2><ul>
<li><p>可靠传输：发送端发啥，接收端收啥！</p>
<p>流量控制：控制发送速率，使接收方有足够的缓冲来接收（较高的发送速度和低的接收速度不匹配，此时就需要流量控制）</p>
</li>
<li><p>链路层和传输层的流量控制的区别：</p>
<ul>
<li><p>链路层是点到点的，传输层是端到端的</p>
</li>
<li><p>链路层控制手段：接收方收不下就不回复确认；</p>
<p>传输层：接收方给发送方一个窗口公告</p>
</li>
</ul>
</li>
<li><p>流量控制的方法：</p>
<ul>
<li>停止等待协议：简单，但是信道利用率低</li>
<li>滑动窗口协议：对停止等待协议的优化！后退N帧协议(GBN)||选择重传协议（SR）</li>
</ul>
</li>
<li><p>停止等待协议，或者说滑动窗口解决了哪些问题？</p>
<ul>
<li>流量控制：收不下就不给确认，发不出来</li>
<li>可靠传输：发送方自动重传</li>
</ul>
</li>
<li><p>停止等待协议：（现在都是放在传输层，可以让链路层的工作减轻，数据传输速率更快）</p>
<ul>
<li><p>为什么要有停止等待协议？</p>
<p>除了bit出差错，底层信道还会出现丢包问题（物理线路故障， 设备故障，病毒攻击，路由信息错误等原因，会导致数据报的丢失）。</p>
<p>同时也是为了实现流量控制</p>
</li>
<li><p>什么是停止等待协议?</p>
<p>每发送一个分组就停止发送，等待对方确认，在收到确认后再发送下一个分组。</p>
</li>
<li><p>停止等待协议-有差错情况</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201228193020.png" alt="image-20201228193013783"></p>
<p>保留副本可以在帧丢失或出错时重传，编号可以解决帧的丢失和重复等出错问题</p>
<p>(2)ACK丢失：同样根据超时重传机制，发送方在超时后重发，接收方丢弃重复的帧，重发确认帧</p>
<p>(3)ACK迟到：同上面丢失一样启动重传机制，区别在于ACK到达后被直接丢弃</p>
</li>
<li><p>停止等待协议的优缺点：</p>
<p>有点：简单；缺点：信道利用率低</p>
</li>
</ul>
</li>
<li><p>滑动窗口中的后退N帧协议GBN：</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201229101338.png" alt="image-20201229101338461" style="zoom:67%;" /></p>
<p>需要注意的几点：</p>
<ul>
<li>累积确认，即对于ACKn，发送方认为n帧即以前的帧均发送正确</li>
<li>接收方只按序接收帧，不按序无情丢弃</li>
<li>确认序列号最大的，按序到达的帧，哪怕后序接收到发送同样如此，类似于催更</li>
<li>优缺点：提高信道利用率；缺点：累计确认导致的批量重传问题</li>
</ul>
</li>
<li><p>选择重传协议SR:</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201229103009.png" alt="image-20201229103009531"></p>
</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201229104003.png" alt="image-20201229103945650" style="zoom:67%;" /></p>
<h1 id="4-网络层（负责IP地址）"><a href="#4-网络层（负责IP地址）" class="headerlink" title="4. 网络层（负责IP地址）"></a>4. 网络层（负责IP地址）</h1><h2 id="4-1-基本功能"><a href="#4-1-基本功能" class="headerlink" title="4.1 基本功能"></a><a href="#网络层">4.1 基本功能</a></h2><h2 id="4-2-数据交换方式"><a href="#4-2-数据交换方式" class="headerlink" title="4.2 数据交换方式"></a>4.2 数据交换方式</h2><ul>
<li><p>电路交换</p>
</li>
<li><p>报文交换（存储转发思想）</p>
</li>
<li><p>分组交换（把大的数据块分割成小的数据）</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20201231100849.png" alt="image-20201231100849086"></p>
<p>分组交换是一种串行转发思想，而报文转发毫无疑问是并行的流水线思想</p>
</li>
<li><p>数据报方式：为网络层提供无连接服务(因特网在用)</p>
<ul>
<li>每个分组都会携带源和目的地址</li>
<li>路由器根据分组的目的地址转发分组: 基于路由协议/算法构建<strong><em>转发表</em></strong>—&gt;检索转发表—&gt;每个分组独立选路</li>
</ul>
</li>
<li>虚电路方式：为网络层提供连接服务<ul>
<li>建立连接：每个分组携带<strong>虚电路号</strong>（确定路径），而非目的地址。源主机发送”呼叫请求“分组，并收到“呼叫应答”分组后才算建立连接</li>
<li>数据传输：   </li>
</ul>
</li>
</ul>
<blockquote>
<p>无连接服务：不事先为分组的传输确定传输路径，每个分组的传输路径可能不同，分组无法按序发送</p>
<p>连接方式：首先为分组的传输确定传输路径（建立连接），然后沿该路径（连接）传播系列分组，系列分组传输路径相同，传输结束后拆除连接，分组无需再排序组合   </p>
</blockquote>
<h2 id="4-3-路由地址和路由转发协议"><a href="#4-3-路由地址和路由转发协议" class="headerlink" title="4.3 路由地址和路由转发协议"></a>4.3 路由地址和路由转发协议</h2><p><img src="https://gitee.com/biongd/img/raw/master/img/20201231105406.png" alt="image-20201231105406552"></p>
<h3 id="4-3-1-路由表"><a href="#4-3-1-路由表" class="headerlink" title="4.3.1 路由表"></a>4.3.1 路由表</h3><p>存放路由信息的地方！</p>
<ul>
<li><font size="5" color="red">路由条目必须包括的五项内容：</font>

<p><strong>前缀+掩码： 表示为哪些数据报进行服务！</strong></p>
<ul>
<li>以10.1.1.0/24为例（也可以是25/26，因为10.1.1.0可以理解为网络号，/后面的是子网掩码为1的位长度）：此时可以服务的网段：10.1.1.1-10.1.1.255</li>
</ul>
<p><strong>下一跳/出接口：从哪个接口转发出去</strong></p>
<p>管理距离（AD）（优先级——对应路由表的pre）：由本条路由使用的路由协议决定</p>
<p>度量（开销——对应路由表的cost）</p>
</li>
<li><font size="5" color="red">路由器转发IP数据报的原则：</font>

<p><strong>有路由匹配就转发，没有就丢弃</strong></p>
<ul>
<li>路由表的前缀和掩码已经决定了路由器的服务范围，不在范围内的路由（10.2.2.0/24）就直接丢弃</li>
</ul>
<p><strong>匹配多条路由时遵循最长匹配原则</strong></p>
<ul>
<li>即如果有多个匹配目的网络的路由条目，则路由器会选择掩码最长的条目</li>
</ul>
<p>路由表生成的3中途径：</p>
<ul>
<li>直连自动生成</li>
<li>静态路由协议</li>
<li>动态路由协议</li>
</ul>
</li>
</ul>
<h3 id="4-3-2-路由协议"><a href="#4-3-2-路由协议" class="headerlink" title="4.3.2 路由协议"></a>4.3.2 路由协议</h3><p>路由协议用于路由器之间帮助路由器构建路由表的网络协议</p>
<p>对于小型网络（家庭）：只需要静态路由协议和直连就可以构建完整路由表</p>
<p>对于大型网络：必须使用动态路由协议让路由器之间相互学习路由信息，从而构建完整的路由表</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210206141555.png" alt="image-20210206141555503" style="zoom: 67%;" /></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210206141902.png" alt="image-20210206141902360" style="zoom:67%;" /></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210206142117.png" alt="image-20210206142116999" style="zoom:67%;" /></p>
<h2 id="4-4-IP"><a href="#4-4-IP" class="headerlink" title="4.4 IP"></a>4.4 IP</h2><h3 id="4-4-1-IP首部格式"><a href="#4-4-1-IP首部格式" class="headerlink" title="4.4.1 IP首部格式"></a>4.4.1 IP首部格式</h3><p><img src="C:/Users/biongd/AppData/Roaming/Typora/typora-user-images/image-20210204174436159.png" alt="image-20210204174436159" style="zoom: 67%;" /></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210204175235.png" alt="image-20210204175235441" style="zoom:67%;" /></p>
<ul>
<li><strong>IP数据报和分组的关系：</strong>IP数据报过长，超出MTU的范围，就需要进行分片，分片的结果即分组</li>
<li>TTL(生存时间)：经过一个路由器减一。 字段为 0 时，数据报被丢弃，并且发送 ICMP 报文通知源主机。 目的是防止数据报在选路时无休止地在网络中流动。</li>
<li>协议：<img src="https://gitee.com/biongd/img/raw/master/img/20210204175835.png" alt="image-20210204175835227" style="zoom:67%;" /></li>
</ul>
<h3 id="4-4-2-IP数据报分片"><a href="#4-4-2-IP数据报分片" class="headerlink" title="4.4.2  IP数据报分片"></a>4.4.2  IP数据报分片</h3><p>由标识，标志和片偏移决定</p>
<ul>
<li><p>标识：同一数据报的分片使用同一标识</p>
</li>
<li><p>标志：3位，只有后两位有意义，中间位（DF）决定是否分片，最低位（MF）决定后面还有没有分片</p>
<p>DF=0：分片，此时MF的值才有意义！DF=1：禁止分片</p>
<p>MF=1：后面还有分片，=0：不是最后一片或者没有分片！</p>
</li>
<li><p>片偏移：分片在原本数据报中的相对位置，以8Byte为单位</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210204184844.png" alt="image-20210204184844777" style="zoom:67%;" /></p>
</li>
</ul>
<h3 id="4-4-3-IPv4地址"><a href="#4-4-3-IPv4地址" class="headerlink" title="4.4.3 IPv4地址"></a>4.4.3 IPv4地址</h3><p>IP地址的历史阶段：分类的IP地址——子网的划分——构成超网</p>
<p>IP地址的概念：全世界唯一的32位/4字节的标识符，标识路由器/主机的接口，比如有线和无线就是不同接口，路由器连接的多个主机或路由器同样是多个接口</p>
<ul>
<li>IP地址：：{网络号，主机号}</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210204190222.png" alt="image-20210204190222792" style="zoom: 50%;" /></p>
<ul>
<li><p>IP地址的分类</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210204220139.png" alt="image-20210204220139080" style="zoom:67%;" /></p>
<p>比如同一网络上的主机数过多时就需要考虑主机号的位数</p>
</li>
<li><p>特殊网址</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210204213946.png" alt="image-20210204213946597" style="zoom: 67%;" /></p>
</li>
</ul>
<p>第二行错误，源地址和目的地址栏应该和第一行相同</p>
<p>第三行：向本网的所有主机发送广播，路由不转发</p>
<p>第五行：向特定值指向的网络发送广播</p>
<ul>
<li><p>私有IP地址（内部IP地址）</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210204214916.png" alt="image-20210204214916820" style="zoom:50%;" /></p>
<ul>
<li>网段个数：网络号的个数</li>
<li>路由器对目的地址是私有IP地址的数据报一律不进行转发</li>
</ul>
<p><strong><font size="5">问题来了：本地和互联网如何建立通信呢？</font></strong></p>
</li>
</ul>
<h3 id="4-4-4-网络地址转换NAT（Network-Address-Translation）"><a href="#4-4-4-网络地址转换NAT（Network-Address-Translation）" class="headerlink" title="4.4.4 网络地址转换NAT（Network Address Translation）"></a>4.4.4 网络地址转换NAT（Network Address Translation）</h3><p><img src="https://gitee.com/biongd/img/raw/master/img/20210204221259.png" alt="image-20210204221258930" style="zoom:50%;" /></p>
<p>实际上也就是对公网IP地址通过端口号进行划分</p>
<h3 id="4-4-5-子网划分和子网掩码"><a href="#4-4-5-子网划分和子网掩码" class="headerlink" title="4.4.5 子网划分和子网掩码"></a>4.4.5 子网划分和子网掩码</h3><ul>
<li><p>子网划分：解决IP分类造成的IP地址资源浪费和地址分配不灵活的问题</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210204223548.png" alt="image-20210204223548882" style="zoom:50%;" /></p>
</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210204225513.png" alt="image-20210204225513873" style="zoom:50%;" /></p>
<p>即首先通过网络号找到路由器，再根据子网号找到子网，最后再根据主机号找到主机！ </p>
<p>二级IP地址的子网掩码：所有的网络号全1，主机号全0</p>
<p>三级IP地址的子网掩码：所有的网络号和子网号全1，主机号全0</p>
<p>由此可见子网掩码的作用就是标识哪些位标志网络/子网号，哪些位标志主机号</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210206122555.png" alt="image-20210206122534057" style="zoom:50%;" /></p>
<h2 id="4-5-ARP协议"><a href="#4-5-ARP协议" class="headerlink" title="4.5 ARP协议"></a>4.5 ARP协议</h2><p>局域网内部：<br><img src="https://gitee.com/biongd/img/raw/master/img/20210209002312.png" alt="image-20210209002312489" style="zoom:67%;" /></p>
<p>每个主机和路由器都有一个ARP高速缓存（局域网内部），如果高速缓存中没有目的IP地址对应的MAC地址，就需要ARP协议进行获取</p>
<p>不同网络：</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210206154050.png" alt="image-20210206154050805" style="zoom:67%;" /></p>
<ul>
<li>1号主机检索过后发现目的IP地址和自己不在同一网段，则下一跳会自动选择默认网关！这时候就需要默认网关路由器的MAC地址</li>
<li>IP地址自始至终是不变得，因为IP协议是端到端的，但是mac地址是随着链路的改变不断变化的！</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210206161251.png" alt="image-20210206161251541" style="zoom:67%;" /></p>
<h2 id="4-6-ICMP协议（网际控制报文协议）"><a href="#4-6-ICMP协议（网际控制报文协议）" class="headerlink" title="4.6 ICMP协议（网际控制报文协议）"></a>4.6 ICMP协议（网际控制报文协议）</h2><p><strong>功能：支持主机</strong></p>
<ul>
<li>差错（或异常）报告</li>
<li>网络探询</li>
</ul>
<h3 id="4-6-1-差错报告报文"><a href="#4-6-1-差错报告报文" class="headerlink" title="4.6.1 差错报告报文"></a>4.6.1 差错报告报文</h3><p>1、差错报告分类</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210206162928.png" alt="image-20210206162928100" style="zoom:67%;" /></p>
<p>2、差错报告报文字段</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210206163012.png" alt="image-20210206163012361" style="zoom:67%;" /></p>
<p>3、不应发送ICMP差错报告报文的情况</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210206163136.png" alt="image-20210206163136492" style="zoom:67%;" /></p>
<h3 id="4-6-2-网络探询报文"><a href="#4-6-2-网络探询报文" class="headerlink" title="4.6.2 网络探询报文"></a>4.6.2 网络探询报文</h3><p><img src="https://gitee.com/biongd/img/raw/master/img/20210206163335.png" alt="image-20210206163335632" style="zoom:67%;" /></p>
<p>2、应用</p>
<p>PING：测试主机之间的连通性，使用ICMP回送请求和回答报文。利用了网络探询的功能</p>
<p>TRACEROUNTE：跟踪一个分组从原点到终点的路径，使用了ICMP时间超过差错报告报文</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210206162839.png" alt="image-20210206162839552" style="zoom:67%;" /></p>
<h2 id="4-7-DHCP协议"><a href="#4-7-DHCP协议" class="headerlink" title="4.7 DHCP协议"></a>4.7 DHCP协议</h2><p>IP地址的动态配置：<br>当有主机加入局域网当中，DHCP服务器就会自动从地址池中分配IP地址，当主机离开后将IP地址收回地址池。</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210209121717.png" alt="image-20210209121710815"></p>
<h1 id="5-传输层"><a href="#5-传输层" class="headerlink" title="5. 传输层"></a>5. 传输层</h1><h2 id="5-1-传输层概述-只有主机才有的层次"><a href="#5-1-传输层概述-只有主机才有的层次" class="headerlink" title="5.1 传输层概述(只有主机才有的层次)"></a>5.1 传输层概述(只有主机才有的层次)</h2><h3 id="5-1-1功能："><a href="#5-1-1功能：" class="headerlink" title="5.1.1功能："></a>5.1.1<a href="#传输层">功能</a>：</h3><ul>
<li><p>传输层提供进程和进程之间的逻辑通信，网络层提供的是主机和主机之间的逻辑通信</p>
</li>
<li><p>复用和分用</p>
<p>以送快递为例：由快递员对多个购物人的快递进行揽收和同一发送就是服用；将快递送到每个购物人手里就是分发（购物人即进程）</p>
</li>
<li><p>传输层对收到的报文进行差错控制（传输层对数据报进行检错，网络层则只需要检测IP数据报的头部）</p>
</li>
</ul>
<h3 id="5-1-2-寻址与端口"><a href="#5-1-2-寻址与端口" class="headerlink" title="5.1.2 寻址与端口"></a>5.1.2 寻址与端口</h3><p><img src="https://gitee.com/biongd/img/raw/master/img/20210207180701.png" alt="image-20210207180645950" style="zoom:67%;" /></p>
<ul>
<li><p>常用端口号</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210207180742.png" alt="image-20210207180742581" style="zoom:67%;" /></p>
</li>
</ul>
<h2 id="5-2-UDP（无连接的用户数据报协议）"><a href="#5-2-UDP（无连接的用户数据报协议）" class="headerlink" title="5.2 UDP（无连接的用户数据报协议）"></a>5.2 UDP（无连接的用户数据报协议）</h2><h3 id="5-2-1-UDP协议概述"><a href="#5-2-1-UDP协议概述" class="headerlink" title="5.2.1 UDP协议概述"></a>5.2.1 UDP协议概述</h3><ul>
<li>无连接</li>
<li>不可靠</li>
<li>面向报文</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210207183445.png" alt="image-20210207183445148" style="zoom:67%;" /></p>
<h3 id="5-2-2-UDP首部格式"><a href="#5-2-2-UDP首部格式" class="headerlink" title="5.2.2 UDP首部格式"></a>5.2.2 UDP首部格式</h3><p><img src="https://gitee.com/biongd/img/raw/master/img/20210207200619.png" alt="image-20210207200619228" style="zoom:67%;" /></p>
<h3 id="5-2-3-数据检验和如何实现"><a href="#5-2-3-数据检验和如何实现" class="headerlink" title="5.2.3 数据检验和如何实现"></a>5.2.3 数据检验和如何实现</h3><p><img src="https://gitee.com/biongd/img/raw/master/img/20210207200724.png" alt="image-20210207200724833" style="zoom:67%;" /></p>
<ul>
<li>伪首部的意思就是假的IP首部（因为包含IP源和目的地址），12字节，用于构造数据检验和</li>
<li>17：协议字段，标识该报文使用UDP协议，解析时也用UDP协议进行解析</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210207201024.png" alt="image-20210207201024321" style="zoom:67%;" /></p>
<ul>
<li>填充伪首部</li>
<li>全0填充检验和字段</li>
<li>全0填充数据字段，使其为4字节的整数倍</li>
<li>伪首部+首部+数据部分：求和（补码），再将和求反码填入检验和字段</li>
<li>去掉伪首部-发送 </li>
</ul>
<p>接收端</p>
<ul>
<li>填充伪首部</li>
<li>将三部分求和（补码）</li>
<li>结果为1则无差错，否则丢弃数据报/交给应用层附上出错警告</li>
</ul>
<h2 id="5-3-TCP协议"><a href="#5-3-TCP协议" class="headerlink" title="5.3 TCP协议"></a>5.3 TCP协议</h2><h3 id="5-3-1-特点"><a href="#5-3-1-特点" class="headerlink" title="5.3.1 特点"></a>5.3.1 特点</h3><p>类似于两个应用进程之间打电话：只有当接收方确认接收才能发送数据</p>
<ul>
<li>面向连接</li>
<li>点对点</li>
<li>可靠有序，不丢不重</li>
<li>全双工</li>
<li>面向字节流（区别于UDP的面向报文）</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210208084434.png" alt="image-20210208084426953" style="zoom:67%;" /></p>
<h3 id="5-3-2-首部格式"><a href="#5-3-2-首部格式" class="headerlink" title="5.3.2 首部格式"></a>5.3.2 首部格式</h3><p><img src="https://gitee.com/biongd/img/raw/master/img/20210208090154.png" alt="image-20210208090154696"></p>
<ul>
<li>序号（4字节）：如下图所示的字节流中的每个字节都有自己的编号，当TCP缓存中的数据添加首部封装为报文的时候，首部后面紧跟的字节编号就是序号</li>
<li>确认号（4字节）：由接收方发送给发送方，确认号为N，表示编号N-1之前的数据都已收到，下一个发送的序号应该为N</li>
<li>数据偏移（4bit）：其实就是首部长度（因为选项和填充部分的存在，不一定就是20字节）</li>
<li>6个控制位：紧急位（URG），确认位（ACK），推送位（PSH），复位（RST），同部位（SYN），终止位（FIN）</li>
<li>窗口：发送本报文的一方的接收窗口，即允许对方发送的数据量（作为接收方一次只能接收的数据量）</li>
<li>检验和：同样依靠12字节的伪首部，和UDP不同的地方是第四个字段（协议字段）的值为6</li>
<li>紧急指针：URG=1时生效，指出紧急数据的字节数（从紧跟首部的第一个字节开始）</li>
<li>选项：最大报文段长度MSS，窗口扩大，时间戳，选择确认。。。</li>
</ul>
<p>首部中的很多参数都是为了实现面向字节流设置的：</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210208090400.png" alt="image-20210208090400742" style="zoom: 50%;" /></p>
<h3 id="5-3-3-TCP连接管理"><a href="#5-3-3-TCP连接管理" class="headerlink" title="5.3.3 TCP连接管理"></a>5.3.3 TCP连接管理</h3><p>TCP传输的三个阶段：</p>
<p>建立连接&gt;&gt;数据传送&gt;&gt;连接释放</p>
<ul>
<li><p>建立连接(3次握手)：</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210208122706.png" alt="image-20210208122706365" style="zoom:67%;" /></p>
</li>
<li><p>连接释放（4次挥手）:</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210208122735.png" alt="image-20210208122735365" style="zoom:67%;" /></p>
</li>
<li><p>实际连接、传送和释放过程</p>
<p><img src="https://ewr1.vultrobjects.com/imgspice2/000/006/177/725_959_74a.jpg" alt="这里写图片描述"></p>
<ul>
<li>第三次握手和四次挥手的第二、三次之间不一定有数据传送</li>
<li>连接建立后会处于保持阶段，这时候客户机也可以向服务器发送数据（如cookie等），当然双方也都可以只回复确认不携带数据</li>
</ul>
</li>
</ul>
<h3 id="5-3-4-TCP可靠传输"><a href="#5-3-4-TCP可靠传输" class="headerlink" title="5.3.4 TCP可靠传输"></a>5.3.4 <a href="#TCP">TCP可靠传输</a></h3><p>TCP实现可靠传输的机制：校验，序号，确认，重传</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210208131738.png" alt="image-20210208131738881" style="zoom:67%;" /></p>
<p>确认和重传两者相辅相成</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210208131826.png" alt="image-20210208131826882" style="zoom:67%;" /></p>
<p>重传由两方面决定：</p>
<ul>
<li>自适应算法，动态调整RTTs（加权平均往返时间）</li>
<li>冗余ACK（冗余确认）：解决超时重传造成的时间浪费</li>
</ul>
<h3 id="5-3-5-TCP流量控制"><a href="#5-3-5-TCP流量控制" class="headerlink" title="5.3.5 TCP流量控制"></a>5.3.5 TCP流量控制</h3><p>让发送方发慢点，要让接收方来得及接收</p>
<p>TCP利用滑动窗口机制实现流量控制</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210208214237.png" alt="image-20210208214237593"></p>
<p>接收方在TCP缓存满的时候就向发送方发送窗口为0，此时停止发送，接收方会向应用层（进程）提交数据，此时窗口空闲，发送方可以发送</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210208215617.png" alt="image-20210208215616946" style="zoom:67%;" /></p>
<p>图中表示的就是滑动窗口机制下的流量控制：图中所示的接收方三次确认报文的窗口大小都是在限制发送方的窗口</p>
<p>第一次：接收窗口400字节，发送方就可以准备4个报文段</p>
<p>第二次：接收窗口300字节，确认号201，发送方就将窗口移动到201，且窗口大小为300个字节。</p>
<p>第三次：最后接收方的窗口大小为0，此时发送方将窗口移动到601，但窗口大小为0。</p>
<p>为了避免接收方窗口出现空闲时返回给发送方的确认信息丢失，导致死锁，此时发送方就需要启动持续计时器。</p>
<h3 id="5-2-6-TCP拥塞控制"><a href="#5-2-6-TCP拥塞控制" class="headerlink" title="5.2.6 TCP拥塞控制"></a>5.2.6 TCP拥塞控制</h3><p><img src="https://gitee.com/biongd/img/raw/master/img/20210208225746.png" alt="image-20210208225746175" style="zoom:80%;" /></p>
<ul>
<li><p>流量控制和拥塞控制的区别</p>
<ul>
<li><p>流量控制是端到端的，因为接收方的窗口大小，限制发送方发送速度</p>
</li>
<li><p>拥塞控制是全局性的，因为网络发送堵塞，导致发送方发送的数据无法到达接收方</p>
</li>
</ul>
</li>
<li><p>拥塞控制的四种算法</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210208230126.png" alt="image-20210208230126838" style="zoom:67%;" /></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210208230228.png" alt="image-20210208230228534" style="zoom:67%;" /></p>
</li>
</ul>
<p>  发送方增加拥塞窗口实际就是变相的增加发送窗口，网络拥塞即发送方检测到丢包现象</p>
<p>  此时需要将cwnd重新调整为1，门限值调整为拥塞发生时cwnd的一半</p>
<p>  <img src="https://gitee.com/biongd/img/raw/master/img/20210208231324.png" alt="image-20210208231324277" style="zoom:67%;" /></p>
<p>考虑到如果网络出现拥塞的话就不会收到好几个重复的确认，所以发送方现在认为网络可能没有出现拥塞。所以此时不执行慢开始算法，而是将 cwnd 设置为 ssthresh 的大小，然后执行拥塞避免算法。</p>
<h1 id="6-应用层"><a href="#6-应用层" class="headerlink" title="6. 应用层"></a>6. 应用层</h1><h2 id="6-1-概述"><a href="#6-1-概述" class="headerlink" title="6.1 概述"></a>6.1 概述</h2><p><img src="https://gitee.com/biongd/img/raw/master/img/20210208231721.png" alt="image-20210208231715191"></p>
<h2 id="6-2-网络应用模型"><a href="#6-2-网络应用模型" class="headerlink" title="6.2 网络应用模型"></a>6.2 网络应用模型</h2><h3 id="6-2-1-客户-服务器（c-s）模型"><a href="#6-2-1-客户-服务器（c-s）模型" class="headerlink" title="6.2.1 客户/服务器（c/s）模型"></a>6.2.1 客户/服务器（c/s）模型</h3><p><img src="https://gitee.com/biongd/img/raw/master/img/20210208232156.png" alt="image-20210208232156469" style="zoom:67%;" /></p>
<h3 id="6-2-2-p2p（peer-to-peer）模型"><a href="#6-2-2-p2p（peer-to-peer）模型" class="headerlink" title="6.2.2 p2p（peer to peer）模型"></a>6.2.2 p2p（peer to peer）模型</h3><p><img src="https://gitee.com/biongd/img/raw/master/img/20210208232605.png" alt="image-20210208232604980" style="zoom:67%;" /></p>
<h2 id="6-3-域名解析系统DNS"><a href="#6-3-域名解析系统DNS" class="headerlink" title="6.3 域名解析系统DNS"></a>6.3 域名解析系统DNS</h2><h2 id="6-4-文件传送协议FTP"><a href="#6-4-文件传送协议FTP" class="headerlink" title="6.4 文件传送协议FTP"></a>6.4 文件传送协议FTP</h2><p>功能：提供不同种类主机系统（硬，软件体系等都可以不同）之间的文件传输能力</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210208234841.png" alt="image-20210208234841649" style="zoom:67%;" /></p>
<h2 id="6-5-万维网和Http协议"><a href="#6-5-万维网和Http协议" class="headerlink" title="6.5 万维网和Http协议"></a>6.5 万维网和Http协议</h2><p><img src="https://gitee.com/biongd/img/raw/master/img/20210209122252.png" alt="image-20210209122252537"></p>
<h3 id="6-5-1-http协议的概念"><a href="#6-5-1-http协议的概念" class="headerlink" title="6.5.1 http协议的概念"></a>6.5.1 http协议的概念</h3><p>简单来说就是规定如何上网，以及服务器如何提供服务</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210209123025.png" alt="image-20210209123025675"></p>
<ul>
<li><p>http入口端口80：</p>
<p>这里的端口80，就类似于FTP协议的21端口，其作为主进程，负责判断是否有主机向服务器发送请求，一旦接收到请求后就可以建立TCP连接，实现数据传输</p>
<p>端口80这一主服务进程可以理解为理发店的迎宾， 当客户需要剪头，烫头，染发等服务的时候就找到相应的从服务进程。</p>
</li>
<li><p>浏览器可以不用一次传输全部资源</p>
<p>可以先只下载文本部分，需要图片，音频，视频等资源的时候可以再点击链接，重复图中的8步过程。</p>
</li>
</ul>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210209130629.png" alt="image-20210209130629435" style="zoom:67%;" /></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210209130524.png" alt="image-20210209130524880" style="zoom:67%;" /></p>
<ul>
<li>HTTP本身无连接，即不需要接收方发送http应用层面的确认信息，只需要TCP网络层进行三次握手即可建立连接</li>
<li>第二张图可以看出，TCP建立连接时的第三次握手就已经携带了客户方的请求报文。</li>
<li>持久/非持久连接、流水/非流水线<ul>
<li>持久即保持连接不断开，在发送新的请求报文时可以立刻响应</li>
<li>流水线即可以同时发送多个请求报文， 服务器依次响应，客户访问所有资源只需要约一个RTT</li>
</ul>
</li>
</ul>
<h2 id="6-5-2-http请求-响应步骤"><a href="#6-5-2-http请求-响应步骤" class="headerlink" title="6.5.2 http请求/响应步骤"></a>6.5.2 http请求/响应步骤</h2><ul>
<li><p>客户端连接到Web服务器</p>
<p>一个HTTP客户端，通常是浏览器，与Web服务器的HTTP端口（默认为80）建立一个TCP套接字连接。</p>
</li>
<li><p>发送HTTP请求</p>
<p>通过TCP套接字，客户端向Web服务器发送一个文本的请求报文，一个请求报文由请求行、请求头部、空行和请求数据4部分组成。</p>
</li>
<li><p>服务器接受请求并返回HTTP响应</p>
<p>Web服务器解析请求，定位请求资源。服务器将资源复本写到TCP套接字，由客户端读取。一个响应由状态行、响应头部、空行和响应数据4部分组成</p>
</li>
<li><p>释放TCP连接</p>
<p>在HTTP/1.0中默认使用短连接。也就是说，客户端和服务器每进行一次HTTP操作，就建立一次连接，任务结束就中断连接。当客户端浏览器访问的某个HTML或其他类型的Web页中包含有其他的Web资源（如JavaScript文件、图像文件、CSS文件等），每遇到这样一个Web资源，浏览器就会重新建立一个HTTP会话</p>
<p>而从HTTP/1.1起，默认使用长连接，用以保持连接特性。使用长连接的HTTP协议，会在响应头加入这行代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connection:keep-alive</span><br></pre></td></tr></table></figure>
<p>在使用长连接的情况下，当一个网页打开完成后，客户端和服务器之间用于传输HTTP数据的TCP连接不会关闭，客户端再次访问这个服务器时，会继续使用这一条已经建立的连接。Keep-Alive不会永久保持连接，它有一个保持时间，可以在不同的服务器软件（如Apache）中设定这个时间。实现长连接需要客户端和服务端都支持长连接。HTTP协议的长连接和短连接，实质上是TCP协议的长连接和短连接。</p>
</li>
<li><p>客户端浏览器解析HTML内容</p>
<p>客户端浏览器首先解析状态行，查看表明请求是否成功的状态代码。然后解析每一个响应头，响应头告知以下为若干字节的HTML文档和文档的字符集。客户端浏览器读取响应数据HTML，根据HTML的语法对其进行格式化，并在浏览器窗口中显示</p>
</li>
</ul>
<p>例如：在浏览器地址栏键入URL，按下回车之后会经历以下流程：</p>
<ol>
<li>浏览器向 DNS 服务器请求解析该 URL 中的域名所对应的 IP 地址;</li>
<li>解析出 IP 地址后，根据该 IP 地址和默认端口 80，和服务器建立TCP连接;</li>
<li>浏览器发出读取文件(URL 中域名后面部分对应的文件)的HTTP 请求，该请求报文作为 TCP 三次握手的第三个<br>报文的数据发送给服务器;</li>
<li>服务器对浏览器请求作出响应，并把对应的 html 文本发送给浏览器;</li>
<li>浏览器将该 html 文本并显示内容;</li>
</ol>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210416204124.png" alt="image-20210416204117224"></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210416204132.png" alt="image-20210416204132515"></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210416204150.png" alt="image-20210416204150604"></p>
<h2 id="6-5-3-http请求的8种方法"><a href="#6-5-3-http请求的8种方法" class="headerlink" title="6.5.3 http请求的8种方法"></a>6.5.3 http请求的8种方法</h2><p>HTTP/1.1协议中共定义了八种方法（也叫“动作”）来以不同方式操作指定的资源：</p>
<ul>
<li><p>GET</p>
<p>指定的资源发出“显示”请求。使用GET方法应该只用在读取数据，而不应当被用于产生“副作用”的操作中，例如在Web Application中。其中一个原因是GET可能会被网络蜘蛛等随意访问。</p>
</li>
<li><p>HEAD</p>
<p>与GET方法一样，都是向服务器发出指定资源的请求。只不过服务器将不传回资源的本文部分。它的好处在于，使用这个方法可以在不必传输全部内容的情况下，就可以获取其中“关于该资源的信息”（元信息或称元数据）。</p>
</li>
<li><p>POST</p>
<p>向指定资源提交数据，请求服务器进行处理（例如提交表单或者上传文件）。数据被包含在请求本文中。这个请求可能会创建新的资源或修改现有资源，或二者皆有。</p>
</li>
<li><p>PUT<br>向指定资源位置上传其最新内容。</p>
</li>
<li>DELETE<br>请求服务器删除Request-URI所标识的资源。</li>
<li><p>TRACE<br>回显服务器收到的请求，主要用于测试或诊断。</p>
</li>
<li><p>OPTIONS<br>这个方法可使服务器传回该资源所支持的所有HTTP请求方法。用’*’来代替资源名称，向Web服务器发送OPTIONS请求，可以测试服务器功能是否正常运作。</p>
</li>
<li>CONNECT</li>
</ul>
<h1 id="7-技术"><a href="#7-技术" class="headerlink" title="7. 技术"></a>7. 技术</h1><h2 id="7-1-内网穿透"><a href="#7-1-内网穿透" class="headerlink" title="7.1 内网穿透"></a>7.1 内网穿透</h2><ul>
<li><p>为啥要内网穿透</p>
<p>网络地址转换（Network Address  Translation，NAT）机制的问题在于，NAT设备自动屏蔽了非内网主机主动发起的连接，也就是说，从外网发往内网的数据包将被NAT设备丢弃，这使得位于不同NAT设备之后的主机之间无法直接交换信息。这一方面保护了内网主机免于来自外部网络的攻击，另一方面也为P2P通信带来了一定困难。Internet上的NAT设备大多是地址限制圆锥形NAT或端口限制圆锥形 NAT，外部主机要与内网主机相互通信，必须由内网主机主动发起连接，使 NAT设备产生一个映射条目，这就有必要研究一下内网穿透技术。</p>
</li>
<li><p>怎么做到的</p>
<ul>
<li>通信双方有一台位于NAT后</li>
</ul>
<p>一台主机有一个公网 IP，另一台主机有一个内网 IP。如图1所示，Client A 位于 NAT 之后，并拥有[IP  地址：端口]对[10.0.0.1：1234]，Client B位于 NAT 之前，并拥有[IP  地址：端口]对[138.76.29.7：1234]，NAT 拥有公网 IP 155.99.25.11。由于 Client B 有一个公网  IP，Client A 可以直接通过 TCP 连接到[138.76.29.7：1234]，然而，如果 Client B 向 Client A  发起主动连接，则不会成功。此时，需要一个公有的服务器辅助进行内网穿透。Client A 和 Client B 向服务器发起登陆请求，并保持一个  TCP 或 UDP 连接，服务器记录其 IP 地址和端口号，这里服务器对 Client A 是记录其经过 NAT 映射之后的 IP 和端口号。当 Client B 想连接 Client A 时，首先向服务器提出请求，服务器在收到请求后向 Client A 发出打洞命令，并将 Client B 的[IP 地址：端口]对发给 Client A，Client A 根据接收到的 IP地址和端口号向 Client B 发起 TCP  连接或发送 UDP 数据包。接下来 Client A 和Client B 之间便可以建立数据传输通道。 </p>
<ul>
<li>通信双方都位于NAT后</li>
</ul>
<p>两台主机都处于内网中，如图2所示。服务器记录的[IP 地址：端口]对是 Client A 和 Client B 经过 NAT 映射之后的IP  地址和端口号，此时，Client A 和 Client B 之间任意方向的连接请求都会被对方的 NAT 设备屏蔽。Client A  首先向服务器提出连接请求，服务器将 Client A 的 IP地址和端口号对[155.99.25.11:51200]发给 Client B，并向 Client B 发出打洞命令；Client B 收到服务器的打洞命令后首先向[155.99.25.11:51200]发送一定数目的  UDP探测包或 TCP 连接请求，在 NAT B 上打一个方向为[155.99.25.11:51200]的洞，Client B  随后向服务器报告打洞完成；服务器在收到 Client B 的报告后将 Client B 的公网IP  地址和端口号对[110.10.33.10：5000]，此时由于 NAT B  上已经留下了对应于[155.99.25.11:51200]方向的洞，Client A  向[110.10.33.10：5000]发出的数据包或连接请求将不会被丢弃。</p>
</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag"># 网络</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/10/23/java-%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="next" title="数据库">
                <i class="fa fa-chevron-left"></i> 数据库
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/10/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" rel="prev" title="计算机组成原理">
                计算机组成原理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="xujunjie'blog" />
            
              <p class="site-author-name" itemprop="name">xujunjie'blog</p>
              <p class="site-description motion-element" itemprop="description">使一个人有限的生命更加有效也即等于延长了人的生命</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">64</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">33</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#带着问题学网络"><span class="nav-text">带着问题学网络</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1-分层的概念"><span class="nav-text">1. 分层的概念</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-标准化工作及相关组织"><span class="nav-text">1.1 标准化工作及相关组织</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-1-标准化工作"><span class="nav-text">1.1.1 标准化工作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-2-因特网标准的形式"><span class="nav-text">1.1.2 因特网标准的形式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-3-相关组织"><span class="nav-text">1.1.3 相关组织</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-性能指标"><span class="nav-text">1.2 性能指标</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-分层结构"><span class="nav-text">1.3 分层结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-1-为什么要有分层呢"><span class="nav-text">1.3.1 为什么要有分层呢?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-2-怎么分层及分层基本原则"><span class="nav-text">1.3.2 怎么分层及分层基本原则</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-4-参考模型"><span class="nav-text">1.4 参考模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-1-OSI参考模型"><span class="nav-text">1.4.1 OSI参考模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-2-OSI参考模型各层功能及协议"><span class="nav-text">1.4.2 OSI参考模型各层功能及协议</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-5-TCP-IP参考协议"><span class="nav-text">1.5 TCP&#x2F;IP参考协议</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-6-各层主要知识点"><span class="nav-text">1.6 各层主要知识点</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-物理层"><span class="nav-text">2. 物理层</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-概念"><span class="nav-text">2.1 概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-物理层参数"><span class="nav-text">2.2 物理层参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-传输介质"><span class="nav-text">2.3 传输介质</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-物理层两大设备"><span class="nav-text">2.4 物理层两大设备*</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-链路层（沟通物理层和网络层）（负责mac地址）"><span class="nav-text">3. 链路层（沟通物理层和网络层）（负责mac地址）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-基本概念"><span class="nav-text">3.1 基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-功能概述"><span class="nav-text">3.2 功能概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-组帧"><span class="nav-text">3.3 组帧</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-差错控制"><span class="nav-text">3.4 差错控制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-流量控制和可靠传输机制"><span class="nav-text">3.5 流量控制和可靠传输机制*</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-网络层（负责IP地址）"><span class="nav-text">4. 网络层（负责IP地址）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-基本功能"><span class="nav-text">4.1 基本功能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-数据交换方式"><span class="nav-text">4.2 数据交换方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-路由地址和路由转发协议"><span class="nav-text">4.3 路由地址和路由转发协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-1-路由表"><span class="nav-text">4.3.1 路由表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-2-路由协议"><span class="nav-text">4.3.2 路由协议</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-IP"><span class="nav-text">4.4 IP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-1-IP首部格式"><span class="nav-text">4.4.1 IP首部格式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-2-IP数据报分片"><span class="nav-text">4.4.2  IP数据报分片</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-3-IPv4地址"><span class="nav-text">4.4.3 IPv4地址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-4-网络地址转换NAT（Network-Address-Translation）"><span class="nav-text">4.4.4 网络地址转换NAT（Network Address Translation）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-5-子网划分和子网掩码"><span class="nav-text">4.4.5 子网划分和子网掩码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5-ARP协议"><span class="nav-text">4.5 ARP协议</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-6-ICMP协议（网际控制报文协议）"><span class="nav-text">4.6 ICMP协议（网际控制报文协议）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-1-差错报告报文"><span class="nav-text">4.6.1 差错报告报文</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-2-网络探询报文"><span class="nav-text">4.6.2 网络探询报文</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-7-DHCP协议"><span class="nav-text">4.7 DHCP协议</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-传输层"><span class="nav-text">5. 传输层</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-传输层概述-只有主机才有的层次"><span class="nav-text">5.1 传输层概述(只有主机才有的层次)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-1功能："><span class="nav-text">5.1.1功能：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-2-寻址与端口"><span class="nav-text">5.1.2 寻址与端口</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-UDP（无连接的用户数据报协议）"><span class="nav-text">5.2 UDP（无连接的用户数据报协议）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-1-UDP协议概述"><span class="nav-text">5.2.1 UDP协议概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-2-UDP首部格式"><span class="nav-text">5.2.2 UDP首部格式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-3-数据检验和如何实现"><span class="nav-text">5.2.3 数据检验和如何实现</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-TCP协议"><span class="nav-text">5.3 TCP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-1-特点"><span class="nav-text">5.3.1 特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-2-首部格式"><span class="nav-text">5.3.2 首部格式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-3-TCP连接管理"><span class="nav-text">5.3.3 TCP连接管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-4-TCP可靠传输"><span class="nav-text">5.3.4 TCP可靠传输</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-5-TCP流量控制"><span class="nav-text">5.3.5 TCP流量控制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-6-TCP拥塞控制"><span class="nav-text">5.2.6 TCP拥塞控制</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-应用层"><span class="nav-text">6. 应用层</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-概述"><span class="nav-text">6.1 概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-网络应用模型"><span class="nav-text">6.2 网络应用模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-1-客户-服务器（c-s）模型"><span class="nav-text">6.2.1 客户&#x2F;服务器（c&#x2F;s）模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-2-p2p（peer-to-peer）模型"><span class="nav-text">6.2.2 p2p（peer to peer）模型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-3-域名解析系统DNS"><span class="nav-text">6.3 域名解析系统DNS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-4-文件传送协议FTP"><span class="nav-text">6.4 文件传送协议FTP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-5-万维网和Http协议"><span class="nav-text">6.5 万维网和Http协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-5-1-http协议的概念"><span class="nav-text">6.5.1 http协议的概念</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-5-2-http请求-响应步骤"><span class="nav-text">6.5.2 http请求&#x2F;响应步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-5-3-http请求的8种方法"><span class="nav-text">6.5.3 http请求的8种方法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-技术"><span class="nav-text">7. 技术</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-内网穿透"><span class="nav-text">7.1 内网穿透</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xujunjie'blog</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>


  
  <script src='https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js'></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize("");
    }
  </script>


  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "./public/search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  


  

  

</body>
</html>
