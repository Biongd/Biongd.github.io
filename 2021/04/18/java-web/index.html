<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="java," />










<meta name="description" content="基于socket和计算机网络的知识，学习时要穿插着一起思考！">
<meta property="og:type" content="article">
<meta property="og:title" content="java-web">
<meta property="og:url" content="http://yoursite.com/2021/04/18/java-web/index.html">
<meta property="og:site_name" content="悦来客栈">
<meta property="og:description" content="基于socket和计算机网络的知识，学习时要穿插着一起思考！">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210702172309.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210418160620.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210418161315.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210418161602.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210418161714.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210418161924.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210418162016.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210418162135.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210418162259.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210418162356.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210418162924.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210418165310.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210418165630.png">
<meta property="og:image" content="c:/Users/biongd/AppData/Roaming/Typora/typora-user-images/image-20210418192310618.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210418234921.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210419010142.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210419015334.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210419034353.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210419213725.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210419213941.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210419222810.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210419222837.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210419225751.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210419225859.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210419231751.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210420233833.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210421000911.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210421001757.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210421001833.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210421001912.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210421001948.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210421002019.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210421002052.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210421122914.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210421140851.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210421142948.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210421152453.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210421201140.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210421203306.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210423090919.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210423091302.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210423091325.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210423093323.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210423093517.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210423093620.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210423094532.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210424132756.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210424234756.png">
<meta property="og:image" content="https://gitee.com/biongd/img/raw/master/img/20210424234852.png">
<meta property="article:published_time" content="2021-04-18T04:12:12.000Z">
<meta property="article:modified_time" content="2021-08-29T02:12:48.542Z">
<meta property="article:author" content="xujunjie&#39;blog">
<meta property="article:tag" content="java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/biongd/img/raw/master/img/20210702172309.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","display_updated":true,"offset":12,"b2t":true,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2021/04/18/java-web/"/>





  <title>java-web | 悦来客栈</title>
  








<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">悦来客栈</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">learn and better</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/04/18/java-web/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xujunjie'blog">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悦来客栈">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">java-web</h1>
        

        <div class="post-meta">
          <span class="post-time">
              
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-04-18T12:12:12+08:00">
                2021-04-18
              </time>
            
            
                <span class="post-updated">
                     &nbsp; | &nbsp; 更新于
                     <time itemprop="dateUpdated" datetime="2021-08-29T10:12:48+08:00" content="2021-08-29">
                          2021-08-29
                     </time>
                 </span>
             

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java%E5%AD%A6%E4%B9%A0-JVM-spring-Maven-IDEA-web-%E9%9B%86%E5%90%88-%E6%95%B0%E7%BB%84-String%E4%B8%93%E9%A2%98-%E5%89%8D%E7%AB%AF-web%E5%AE%9E%E6%88%98-%E5%9F%BA%E7%A1%80-redis-%E6%A6%82%E5%BF%B5/" itemprop="url" rel="index">
                    <span itemprop="name">java学习-JVM.spring.Maven.IDEA.web.集合/数组/String专题.前端.web实战.基础.redis.概念.</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>基于socket和计算机网络的知识，学习时要穿插着一起思考！</p>
<a id="more"></a>
<h1 id="1-web服务器及tomcat"><a href="#1-web服务器及tomcat" class="headerlink" title="1. web服务器及tomcat"></a>1. web服务器及tomcat</h1><h2 id="1-1-web服务器的概念"><a href="#1-1-web服务器的概念" class="headerlink" title="1.1 web服务器的概念"></a>1.1 web服务器的概念</h2><h3 id="两种开发模型"><a href="#两种开发模型" class="headerlink" title="两种开发模型"></a>两种开发模型</h3><ul>
<li><p><strong>C/S又称Client/Server或客户/服务器模式</strong>。服务器通常采用高性能的PC、工作站或小型机，客户端需要安装专用的客户端软件。如QQ,微信等软件</p>
</li>
<li><p><strong>B/S是Brower/Server的缩写</strong>，客户机上只要安装一个浏览器（Browser）。Browser/Server是建立在广域网的基础上的。</p>
</li>
<li><p>CS和BS结构各自的优、缺点</p>
<ul>
<li><p>C/S的优点：</p>
<p>是能<strong>充分发挥客户端PC的处理能力</strong>，很多工作可以在客户端处理后再提交给服务器。对应的优点就是客户端响应速度快。</p>
</li>
<li><p>C/S的缺点：</p>
<p>客户端需要<strong>安装专用的客户端软件</strong>。首先涉及到安装的工作量，其次任何一台电脑出问题，如病毒、硬件损坏，都<strong>需要进行安装或维护</strong>。特别是有很多分部或专卖店的情况，不是工作量的问题，而是<strong>路程的问题</strong>。还有，系统软件升级时，每一台客户机需要重新安装，其维护和升级成本非常高。</p>
</li>
<li><p>B/S最大的优点：</p>
<p>可以在任何地方进行操作而不用安装任何专门的软件。只要有一台能上网的电脑就能使用，客户端零维护。系统的扩展非常容易，只要能上网，就可以使用了。甚至可以在线申请，通过公司内部的安全认证（如CA证书）后，不需要人的参与，系统可以自动分配给用户一个账号进入系统。</p>
</li>
</ul>
</li>
</ul>
<h3 id="web服务器分类"><a href="#web服务器分类" class="headerlink" title="web服务器分类"></a>web服务器分类</h3><p>Web服务器是运行及发布Web应用的容器，只有将开发的Web项目放置到该容器中，才能使网络中的所有用户通过浏览器进行访问。开发Java Web应用所采用的服务器主要是与JSP/Servlet兼容的Web服务器，比较常用的有Tomcat、Resin、JBoss、WebSphere 和 WebLogic 等</p>
<ul>
<li><p>Tomcat 服务器</p>
<p>目前最为流行的Tomcat服务器是Apache-Jarkarta开源项目中的一个子项目，是一个小型、轻量级的支持JSP和Servlet 技术的Web服务器，也是初学者学习开发JSP应用的首选</p>
</li>
<li><p>Resin 服务器<br>Resin是Caucho公司的产品，是一个非常流行的支持Servlet和JSP的服务器，速度非常快。Resin本身包含了一个支持HTML的Web服务器，这使它不仅可以显示动态内容，而且显示静态内容的能力也毫不逊色，因此许多网站都是使用Resin服务器构建</p>
</li>
<li><p>JBoss服务器</p>
<p>JBoss是一个种遵从JavaEE规范的、开放源代码的、纯Java的EJB服务器，对于J2EE有很好的支持。JBoss采用JML API实现软件模块的集成与管理，其核心服务又是提供EJB服务器，不包含Servlet和JSP的Web容器，不过它可以和Tomcat完美结合</p>
</li>
<li><p>WebSphere 服务器</p>
<p>WebSphere是IBM公司的产品，可进一步细分为 WebSphere Performance Pack、Cache Manager 和WebSphere Application Server等系列，其中WebSphere Application Server 是基于Java 的应用环境，可以运行于 Sun Solaris、Windows NT 等多种操作系统平台，用于建立、部署和管理Internet和Intranet Web应用程序。</p>
</li>
<li><p>WebLogic 服务器<br>WebLogic 是BEA公司的产品（现在已经被Oracle收购），可进一步细分为 WebLogic Server、WebLogicEnterprise 和 WebLogic Portal 等系列，其中 WebLogic Server 的功能特别强大。WebLogic 支持企业级的、多层次的和完全分布式的Web应用，并且服务器的配置简单、界面友好。对于那些正在寻求能够提供Java平台所拥有的一切应用服务器的用户来说，WebLogic是一个十分理想的选择</p>
</li>
</ul>
<h2 id="1-2-tomcat"><a href="#1-2-tomcat" class="headerlink" title="1.2 tomcat"></a>1.2 tomcat</h2><h3 id="1-2-1-Tomcat下载与安装"><a href="#1-2-1-Tomcat下载与安装" class="headerlink" title="1.2.1 Tomcat下载与安装"></a>1.2.1 Tomcat下载与安装</h3><p>下载地址：<a href="https://tomcat.apache.org/" target="_blank" rel="noopener">https://tomcat.apache.org/</a></p>
<p>安装步骤:</p>
<ol>
<li>下载Tomcat</li>
<li>解压到一个没有特殊符号的目录中（一般纯英文即可）</li>
<li>进入到解压的目录下找到bin\startup.bat双击启动即可</li>
</ol>
<p>注意:</p>
<ol>
<li>不建议将服务器软件放在磁盘层次很多的文件夹中!2</li>
<li>不建议放在中文路径下!</li>
<li>tomcat安装需要配置JAVA_HOME环境变量</li>
</ol>
<h3 id="注意：8080端口占用问题！！！"><a href="#注意：8080端口占用问题！！！" class="headerlink" title="注意：8080端口占用问题！！！"></a>注意：8080端口占用问题！！！</h3><p>因为端口占用导致tomcat服务器无法登录：</p>
<p>报错信息：</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cannot locate <span class="built_in">document</span>: /</span><br></pre></td></tr></table></figure>
<p>解决办法：</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210702172309.png" alt="image-20210702172309539" style="zoom: 80%;" /></p>
<p>此时通过localhost：8080就可以成功登录了！！</p>
<h3 id="1-2-2-tomcat的目录"><a href="#1-2-2-tomcat的目录" class="headerlink" title="1.2.2 tomcat的目录"></a>1.2.2 tomcat的目录</h3><ul>
<li><strong>bin：该目录下存放的是二进制可执行文件</strong>，如果是安装版，那么这个目录下会有两个exe文件：tomcat9.exe、tomcat9w.exe，前者是在控制台下启动Tomcat，后者是弹出UGI窗口启动Tomcat；如果是解压版，那么会有startup.bat和shutdown.bat文件，startup.bat用来启动Tomcat，但需要JDK的配置(上文提到的JAVA_HOME路径)，shutdown.bat用来停止Tomcat；</li>
<li><strong>conf：</strong>这是一个<strong>非常非常重要</strong>的目录，这个目录下有四个最为重要的文件：<ul>
<li><strong>server.xml：配置整个服务器信息</strong>。例如修改端口号，添加虚拟主机等；</li>
<li><strong>tomcat-users.xml：存储tomcat用户的文件</strong>，这里保存的是tomcat的用户名及密码，以及用户的角色信息。可以按着该文件中的注释信息添加tomcat用户，然后就可以在Tomcat主页中进入Tomcat Manager页面了；</li>
<li><strong>web.xml：部署描述符文件，</strong>这个文件中注册了很多MIME类型，即文档类型。这些MIME类型是客户端与服务器之间说明文档类型的，如用户请求一个html网页，那么服务器还会告诉客户端浏览器响应的文档是text/html类型的，这就是一个MIME类型。客户端浏览器通过这个MIME类型就知道如何处理它了。当然是在浏览器中显示这个html文件了。但如果服务器响应的是一个exe文件，那么浏览器就不可能显示它，而是应该弹出下载窗口才对。MIME就是用来说明文档的内容是什么类型的！</li>
<li><strong>context.xml：对所有应用的统一配置</strong>，通常我们不会去配置它。</li>
</ul>
</li>
<li><strong>lib：Tomcat的类库，里面是一大堆jar文件。</strong>如果需要添加Tomcat依赖的jar文件，可以把它放到这个目录中，当然也可以把应用依赖的jar文件放到这个目录中，<strong>这个目录中的jar所有项目都可以共享之</strong>，但这样你的应用放到其他Tomcat下时就不能再共享这个目录下的Jar包了，所以<strong>建议只把Tomcat需要的Jar包放到这个目录下</strong>；</li>
<li><strong>logs：这个目录中都是日志文件</strong>，记录了Tomcat启动和关闭的信息，如果启动Tomcat时有错误，那么异常也会<br>记录在日志文件中。</li>
<li><strong>temp：存放Tomcat的临时文件</strong>，这个目录下的东西可以在停止Tomcat后删除！</li>
<li><strong>webapps：存放web项目的目录，其中每个文件夹都是一个项目</strong>；如果这个目录下已经存在了目录，那么都是tomcat自带的项目。其中<strong>ROOT是一个特殊的项目，在地址栏中没有给出项目目录时，对应的就是ROOT项目</strong>。<a href="http://localhost:8080/examples，进入示例项目。其中examples就是项目名，即文件夹的名字。" target="_blank" rel="noopener">http://localhost:8080/examples，进入示例项目。其中examples就是项目名，即文件夹的名字。</a></li>
<li>work：运行时生成的文件，最终运行的文件都在这里。通过webapps中的项目生成的！可以把这个目录下的内容删除，再次运行时会生再次生成work目录。当客户端用户访问一个JSP文件时，Tomcat会通过JSP生成Java文件，然后再编译Java文件生成class文件，生成的java和class文件都会存放到这个目录下。</li>
<li>LICENSE：许可证。</li>
<li>NOTICE：说明文件。</li>
</ul>
<p><strong>如何通过url访问服务器：</strong></p>
<p>url：</p>
<p><a href="http://服务器的ip地址:端口号/项目名/被访问的页面">http://服务器的ip地址:端口号/项目名/被访问的页面</a></p>
<p>示例:</p>
<p><a href="http://localhost:8080/demo_bootstrap/index.html" target="_blank" rel="noopener">http://localhost:8080/demo_bootstrap/index.html</a></p>
<p>用手机访问同一局域网内的笔记本：</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210418160620.png" alt="image-20210418160620306" style="zoom: 25%;" /></p>
<p>需要注意的是：</p>
<ul>
<li>启动tomcat后,tomcat会加载部署在服务器端的所有项目</li>
<li>浏览器访问的页面是服务器端的页面,基本上服务器的项目和工作空间的项目要保持一致</li>
</ul>
<h3 id="1-2-3-IntelliJ-IDEA配置Tomcat"><a href="#1-2-3-IntelliJ-IDEA配置Tomcat" class="headerlink" title="1.2.3 IntelliJ IDEA配置Tomcat"></a>1.2.3 IntelliJ IDEA配置Tomcat</h3><h4 id="创建java-web项目"><a href="#创建java-web项目" class="headerlink" title="创建java-web项目"></a>创建java-web项目</h4><ul>
<li><p>新建module</p>
<p>注意：正常创建普通java项目，而不是Java Enterprise；</p>
</li>
<li><p>添加框架支持</p>
<ul>
<li><p>创建完Java项目后，右击项目，选择Add Frameworks Support；</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210418161315.png" alt="add framework"></p>
</li>
<li><p>选择 Java EE8</p>
</li>
<li><p>选中Web Application，默认create web.xml</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210418161602.png" alt="web.xml"></p>
</li>
</ul>
</li>
<li><p>目录结构变化，如下</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210418161714.png" alt="目录介绍"></p>
</li>
</ul>
<h4 id="对该项目加些配置"><a href="#对该项目加些配置" class="headerlink" title="对该项目加些配置"></a>对该项目加些配置</h4><ul>
<li><p>创建classes和lib文件夹，名字不可改</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210418161924.png" alt="image-20210418161924449"></p>
</li>
<li><p>配置jar包和classes包：</p>
<ul>
<li><p>在File中找到Project Structure</p>
</li>
<li><p>点击Modules ,选择Paths,选中Use module compile output path ,把路径改成刚刚创建的classes文件夹</p>
</li>
<li><p>ok后再点旁边的Dependencies,点击”+”号，选择1 JARs or directories</p>
</li>
<li><p>选择你刚刚创建的lib文件夹，OK</p>
</li>
<li><p>选中jar Directory。</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210418162016.png" alt="image-20210418162016490"></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210418162135.png" alt="image-20210418162135471"></p>
</li>
</ul>
</li>
</ul>
<p>Scope属性</p>
<p>每个依赖项的Scope选项进行该jar包的相关操作设置，默认为compile，根据需要调整设置：</p>
<p>（1）compile设置编译范围内有效，在编译和打包时都会将依赖项加载进去。</p>
<p>（2）test设置测试范围内有效，只在测试时使用，编译和打包时都不会加载该项。</p>
<p>（3）provided设置编译和测试的范围内有效，打包时不会加载该项。</p>
<p>（4）runtime设置在运行时加载该依赖项，但是编译时不依赖。</p>
<h4 id="将本地项目部署到服务器中"><a href="#将本地项目部署到服务器中" class="headerlink" title="将本地项目部署到服务器中"></a>将本地项目部署到服务器中</h4><ul>
<li><p>回到主界面后，点击Run ，选择Edit Configurations，这里可以选择tomcat版本及对其进行一些配置</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210418162259.png" alt="image-20210418162259918"></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210418162356.png" alt="image-20210418162356544"></p>
</li>
<li><p>选择第二个选项卡Deployment-&gt;+-&gt;选择Artifacts，Application context表示工程路径，可以对项目的访问地址进行修改，如果只有一个<code>/</code>，则默认表示<code>localhost:8080/</code>，后面直接跟需要访问的页面即可，Apply；</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210418162924.png" alt="在这里插入图片描述"></p>
</li>
</ul>
<p>此时就可以直接启动tomcat服务器了，idea会自动打开本地浏览器访问Application context中设置的路径！！！</p>
<h3 id="1-2-4-修改端口号"><a href="#1-2-4-修改端口号" class="headerlink" title="1.2.4 修改端口号"></a>1.2.4 修改端口号</h3><p>修改配置文件：/conf/server.xml</p>
<p>如果将端口号改成80,则访问项目时的请求路径就可以省略端口号。（我的80端口被微软系统占用）</p>
<h3 id="1-2-5-tomcat如何管理项目"><a href="#1-2-5-tomcat如何管理项目" class="headerlink" title="1.2.5 tomcat如何管理项目"></a>1.2.5 tomcat如何管理项目</h3><p>给tomcat增加管理员信息:</p>
<p>配置conf/tomcat-users.xml</p>
<p>注意:tomcat启动的时候会加载webapps下的所有项目</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--&lt;Connector port="8888" protocol="HTTP/1.1" connectionTimeout="20000"</span></span><br><span class="line"><span class="comment">redirectPort="8443" /&gt;</span></span><br><span class="line"><span class="comment">&lt;tomcat-users&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">"manager-gui"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span> <span class="attr">username</span>=<span class="string">"tomcat"</span> <span class="attr">password</span>=<span class="string">"tomcat"</span> <span class="attr">roles</span>=<span class="string">"manager-gui"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tomcat-users</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上述两行标签是在第一次登录失败时返回的，将其复制后粘贴进来</p>
<h1 id="2-Servlet"><a href="#2-Servlet" class="headerlink" title="2. Servlet"></a>2. Servlet</h1><p><img src="https://gitee.com/biongd/img/raw/master/img/20210418165310.png" alt="image-20210418165310155"></p>
<ul>
<li><p>概念：</p>
<p>Servlet（Server Applet），全称Java Servlet。是⽤Java编写的服务器端程序，其主要功能在于交互式地浏览和修改数据，⽣成动态Web内容。狭义的Servlet是指Java语⾔实现的⼀个接⼝，⼴义的Servlet是指任何实现了这个Servlet接⼝的类，⼀般情况下，⼈们将Servlet理解为后者。</p>
<p>Servlet运⾏于⽀持Java的应⽤服务器中。从实现上讲，Servlet可以响应任何类型的请求，但绝⼤多数情况下Servlet只⽤来扩展基于HTTP协议的Web服务器。</p>
</li>
<li><p>⼯作模式：<br>① 客户端发送请求⾄服务器<br>② 服务器启动并调⽤Servlet，Servlet根据客户端请求⽣成响应内容并将其传给服务器<br>③ 服务器将响应返回客户端</p>
</li>
</ul>
<h2 id="2-1-Servlet工作原理"><a href="#2-1-Servlet工作原理" class="headerlink" title="2.1 Servlet工作原理"></a>2.1 Servlet工作原理</h2><h3 id="2-1-1-Servlet-API"><a href="#2-1-1-Servlet-API" class="headerlink" title="2.1.1  Servlet API"></a>2.1.1  Servlet API</h3><p><img src="https://gitee.com/biongd/img/raw/master/img/20210418165630.png" alt="image-20210418165630663" style="zoom:67%;" /></p>
<p>创建⼀个类实现Servlet接⼝,重写⽅法。或继承HttpServlet亦可(首先需要导入工具中的jar包) </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">demo1</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"get..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"post..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试 html页面:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我的第一个javaweb项目<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"test"</span>&gt;</span>demo1测试：doGet方法<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"test"</span> <span class="attr">method</span>=<span class="string">"post"</span> &gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"post-test"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在web.xml⽂档中配置映射关系(Servlet服务器类和前端请求间的映射关系)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>a1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.java.demo1<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>a1<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/test<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>理解：</p>
<p> <img src="C:/Users/biongd/AppData/Roaming/Typora/typora-user-images/image-20210418192310618.png" alt="image-20210418192310618"></p>
<p>这里的项目结构实际上就是服务器的结构，当我访问服务器的ip，端口，项目名称时，其实访问的就是html文件所呈现的一个页面</p>
<h3 id="2-1-2-工作原理"><a href="#2-1-2-工作原理" class="headerlink" title="2.1.2 工作原理"></a>2.1.2 工作原理</h3><p>首先：一个应用程序可能有多个Servlet类相绑定！！！如视频中的TestServlet和HttpServlet都对同一个html文件生效</p>
<ul>
<li>Servlet接⼝定义了Servlet与servlet容器之间的契约。这个契约是：Servlet容器将Servlet类载⼊内存，并产⽣Servlet实例和调⽤它具体的⽅法。但是要注意的是，在⼀个应⽤程序中，每种Servlet类型只能有⼀个实例。</li>
<li>⽤户请求致使Servlet容器调⽤Servlet的Service（）⽅法，并传⼊⼀个ServletRequest对象和⼀个ServletResponse对象。ServletRequest对象和ServletResponse对象都是由Servlet容器（例如TomCat）封装好的，并不需要程序员去实现，程序员可以直接使⽤这两个对象。</li>
<li>ServletRequest中封装了当前的Http请求，因此，开发⼈员不必解析和操作原始的Http数据。ServletResponse表示当前⽤户的Http响应，程序员只需直接操作ServletResponse对象就能把响应轻松的发回给⽤户。</li>
<li>对于每⼀个应⽤程序，Servlet容器还会创建⼀个ServletContext对象。这个对象中封装了上下⽂（应⽤程序）的环境详情。每个应⽤程序只有⼀个ServletContext。每个Servlet对象也都有⼀个封装Servlet配置的ServletConfig对象。</li>
</ul>
<h3 id="2-1-3-Servlet的生命周期"><a href="#2-1-3-Servlet的生命周期" class="headerlink" title="2.1.3 Servlet的生命周期"></a>2.1.3 Servlet的生命周期</h3><p>当客户端⾸次发送第⼀次请求后，由容器(web服务器(tomcat))去解析请求, 根据请求找到对应的servlet,判断该类的对象是否存在，不存在则创建servlet实例，调取init()⽅法 进⾏初始化操作</p>
<p>初始化完成后调取service()⽅法,由service()判断客户端的请求⽅式，如果是get，则执⾏doGet(),如果是post则执⾏doPost().处理⽅法完成后,作出相应结果给客户端.单次请求处理完毕。</p>
<p>当⽤户发送第⼆次以后的请求时,会判断对象是否存在,但是不再执⾏init()，⽽直接执⾏service⽅法,调取doGet()/doPost()⽅法。</p>
<p>当服务器关闭时调取destroy()⽅法进⾏销毁。</p>
<p>四个过程:</p>
<ul>
<li><p>实例化 —先创建servlet实例</p>
</li>
<li><p>初始化 —init()</p>
</li>
<li><p>处理请求 —-service()</p>
</li>
<li><p>服务终⽌ —destory()</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210418234921.png" alt="image-20210418234921786" style="zoom:67%;" /></p>
</li>
</ul>
<h2 id="2-2-请求"><a href="#2-2-请求" class="headerlink" title="2.2 请求"></a>2.2 请求</h2><h3 id="2-2-1-常用方法"><a href="#2-2-1-常用方法" class="headerlink" title="2.2.1 常用方法"></a>2.2.1 常用方法</h3><p>HttpServletRequest表示Http环境中的Servlet请求。它扩展于<code>javax.servlet.ServletReques</code>t接⼝<br>常⽤⽅法:</p>
<ul>
<li><code>String getParameter(String name)</code>：根据<strong>表单组件名称</strong>获取提交数据，返回值是String</li>
</ul>
<p>需要在表单标签中加入姓名属性</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  <strong>注：服务器在接收数据时使用字符串统⼀接收</strong></p>
<ul>
<li><p><code>String[ ] getParameterValues(String name)</code>：获取表单组件对应多个值时的请求数据</p>
</li>
<li><p><code>void setCharacterEncoding(String charset)</code>：指定每个请求的编码(针对post请求才起作⽤)</p>
</li>
<li><p><code>RequestDispatcher getRequestDispatcher(String path)</code>： —跳转页面，返回⼀个RequestDispatcher对象，该对象的forward( )⽅法⽤于转发请求<br>示例:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.getRequestDispatcher(<span class="string">"/success.html"</span>).forward(req,resp);</span><br></pre></td></tr></table></figure>
</li>
<li><p>存值<code>request.setAttribute(&quot;key&quot;,value)</code></p>
<p>注：存值得时间域：只能用于一次request请求</p>
</li>
<li><p>取值 <code>request.getAttribute(&quot;key&quot;)</code>取值后需要向下转型</p>
</li>
</ul>
<h3 id="2-2-2-客户端如何发送数据给服务器"><a href="#2-2-2-客户端如何发送数据给服务器" class="headerlink" title="2.2.2 客户端如何发送数据给服务器"></a>2.2.2 客户端如何发送数据给服务器</h3><ol>
<li>通过表单 get/post提交</li>
<li>通过a标签发送数据（get提交）</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"请求名?key=value&amp;key=value&amp;key=value..."</span>&gt;</span></span><br><span class="line">示例:</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/login?a=10&amp;name=abc&amp;pass=123"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这⾥的key值=表单元素的控件名，value值=表单中控件的value属性值</p>
<p>注: 第⼀个参数使⽤?拼接,之后的参数使⽤&amp;拼接，获取数据还是通过<code>String name=request.getParameter(&quot;name&quot;);</code></p>
<ol>
<li><p>通过地址栏直接拼接-get请求</p>
</li>
<li><p>js提交数据-get请求</p>
<p><code>location.href=&quot;⽬标请求?key=value&amp;key=value&quot;</code></p>
<p>注:⽅式2/3都属于get提交⽅式,表单提交可以使⽤get、post提交⽅式</p>
</li>
</ol>
<h3 id="2-2-3-处理请求乱码的问题"><a href="#2-2-3-处理请求乱码的问题" class="headerlink" title="2.2.3 处理请求乱码的问题"></a>2.2.3 处理请求乱码的问题</h3><p>post提交时管⽤</p>
<ol>
<li><code>setCharacterEncoding(&quot;UTF-8&quot;)</code></li>
</ol>
<p>使⽤于get提交</p>
<ol>
<li><p><code>String s=new String(变量名.getBytes(&quot;ISO-8859-1&quot;),&quot;UTF-8&quot;)</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String s=<span class="keyword">new</span> String(request.getParameter(<span class="string">"key"</span>).getBytes(<span class="string">"ISO-8859-1"</span>),<span class="string">"GBK"</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改tomcat中配置⽂件，在Tomcat⽬录结构\conf\server.xml中设置字符集</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"8080"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span></span></span><br><span class="line"><span class="tag"><span class="attr">connectionTimeout</span>=<span class="string">"20000"</span></span></span><br><span class="line"><span class="tag"><span class="attr">redirectPort</span>=<span class="string">"8443"</span> <span class="attr">URIEncoding</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>注意:tomcat8.0以后不需要⼿动设置这个属性了</p>
</li>
</ol>
<h3 id="2-2-4-get和post请求的区别"><a href="#2-2-4-get和post请求的区别" class="headerlink" title="2.2.4 get和post请求的区别"></a>2.2.4 get和post请求的区别</h3><h2 id="2-3-响应"><a href="#2-3-响应" class="headerlink" title="2.3 响应"></a>2.3 响应</h2><p>在Service API中，定义了⼀个HttpServletResponse接⼝，它继承⾃ServletResponse接⼝，专⻔⽤来封装HTTP响应消息。 在HttpServletResponse接⼝中定义了向客户端发送响应状态码，响应消息头，响应消息体的⽅法。</p>
<p>常⽤⽅法:</p>
<ul>
<li><code>void addCookie(Cookie var1);</code>：给这个响应添加⼀个cookie</li>
<li><code>void sendRedirect(String var1)</code>：发送⼀条响应码，将浏览器跳转到指定的位置</li>
<li><code>PrintWriter getWriter()</code>：获得字符流，通过字符流的write(String s)⽅法可以将字符串设置到response缓冲区中，随后Tomcat会将response缓冲区中的内容组装成Http响应返回给浏览器端。</li>
<li><code>setContentType()</code>设置响应内容的类型</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//进行用户信息的判断，没有查到用户就弹窗，查到就跳转到成功页面        </span></span><br><span class="line"><span class="keyword">if</span>(users==<span class="keyword">null</span>)&#123;</span><br><span class="line">    <span class="comment">//以弹窗方式提示用户，登录失败</span></span><br><span class="line">    resp.setContentType(<span class="string">"text/html;charset=utf-8"</span>);</span><br><span class="line">    PrintWriter writer = resp.getWriter();</span><br><span class="line">    writer.println(<span class="string">"&lt;script&gt;location.href='login.jsp';alert('用户名或密码不正确');&lt;/script&gt;"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//跳转到主页面</span></span><br><span class="line">    <span class="comment">//保存用户信息</span></span><br><span class="line">    req.getSession().setAttribute(<span class="string">"u1"</span>,users);</span><br><span class="line">    resp.sendRedirect(<span class="string">"index.jsp"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-3-1-转发和重定向"><a href="#2-3-1-转发和重定向" class="headerlink" title="2.3.1 转发和重定向"></a>2.3.1 转发和重定向</h3><p><img src="https://gitee.com/biongd/img/raw/master/img/20210419010142.png" alt="image-20210419010142600"></p>
<p>转发：对应请求方法</p>
<p><code>request.getRequestDispatcher(&quot;../success.jsp&quot;).forward(request,response)</code></p>
<p>在请求的时候地址栏显示的是我们的请求href字符串<code>testrequest</code>：</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//localhost:8080/testrequest?upass=abc&amp;uage=12</span></span><br></pre></td></tr></table></figure>
<p>一次请求过后服务器直接就把html内容发过来了</p>
<p>重定向：对应响应方法</p>
<p><code>response.sendRedirect()</code></p>
<p>在请求的时候同样是通过href字符串<code>testrequest</code>，但是服务器会把你准备跳转的html文件的名称<code>success.html</code>发回来，这时候就可以拿着这个名字去请求，最终地址栏就更加好看了！</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//localhost:8080/success.html</span></span><br></pre></td></tr></table></figure>
<p>相同点:</p>
<p>都⽤来跳转⻚⾯</p>
<p>不同点:</p>
<p>a.重定向时地址栏会改变,request中存储的数据会丢失.转发时地址栏显示的是请求页面的地址，request数据可以保存。</p>
<p>如上面所示<code>http://localhost:8080/testrequest?upass=abc&amp;uage=12</code>，每一次刷新都能获取数据</p>
<p>b.转发属于⼀次请求⼀次响应,重定向属于两次请求(地址栏修改了两次)两次响应。</p>
<p>补充:使⽤out对象往⻚⾯中输出js或html,css</p>
<h2 id="2-4-session会话"><a href="#2-4-session会话" class="headerlink" title="2.4 session会话"></a>2.4 session会话</h2><p><strong>概念：</strong></p>
<p>request存的值只能在单次请求中保存，保存的数据不能跨页面，当重定向时,request存的值会丢失</p>
<p>session的数据可以在多个页面中共享，即使重定向页面，数据不会丢失</p>
<p>session中可以包含n个request。</p>
<p>会话的概念：从打开浏览器到关闭浏览器,期间访问服务器就称为⼀次会话</p>
<p><strong>常⽤⽅法:</strong></p>
<ul>
<li><p><code>void setAttribute(String key,Object value)</code>：以key/value的形式保存对象值,将数据存储在服务器端</p>
</li>
<li><p><code>Object getAttribute(String key)</code>：通过key获取对象值</p>
</li>
<li><p><code>void invalidate()</code>：设置session对象失效</p>
</li>
<li><p><code>String getId()</code>：获取sessionid,当第⼀次登录成功后，session会产⽣⼀个唯⼀的id，浏览器之后访问时如果发现id值还是之前id，那么说明 当前访问的属于同⼀个会话</p>
</li>
<li><p><code>void setMaxInactiveInterval(int interval)</code>：设定session的⾮活动时间</p>
<p><strong>比如长时间不进行操作会让你重新登录，就是在会话期间没进行任何操作，在指定时间后会退出session，防止资源一直被占用</strong></p>
<p>示例:<br>⽅式1：<code>session.setMaxInactiveInterval(10*60)</code>：设置有效时间为10分钟</p>
<p>⽅式2：修改web.xml</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">&lt;session-config&gt;</span></span><br><span class="line"><span class="params">&lt;session-timeout&gt;</span><span class="number">10</span><span class="params">&lt;/session-timeout&gt;</span><span class="comment">//单位:分钟</span></span><br><span class="line"><span class="params">&lt;/session-config&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>int getMaxInactiveInterval()</code>：获取session的有效⾮活动时间(以秒为单位)，默认的有效时间:30分钟</p>
</li>
<li><code>void removeAttribute(String key)</code>：从session中删除指定名称(key)所对应的对象</li>
</ul>
<p><strong>让session失效的⽅式：</strong>（1）invalidate() （2）removeAttribute(“key”) （3）直接关闭浏览器</p>
<p>可以理解为：每次打开一个新的浏览器的时候、或者是打开一个新的窗口的时候，打开的就是一个新的session会话</p>
<h2 id="2-5-获得初始化参数"><a href="#2-5-获得初始化参数" class="headerlink" title="2.5 获得初始化参数"></a>2.5 获得初始化参数</h2><p>request.setCharacterEncoding(“utf-8”);代码的耦合度太⾼，不便于后期维护修改。可以通过初始化参数实现</p>
<p>实现⽅式:</p>
<ol>
<li><p>web.xml中先定义初始化参数(局部初始化参数)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span><span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span><span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>servlet中获得初始化参数，重写init()⽅法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">    encoding= config.getInitParameter(<span class="string">"encoding"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意:这种⽅式的初始化参数仅限于当前servlet类中使⽤。</p>
</li>
<li><p>全局初始化参数</p>
<p>定义，context-param是和servlet标签同级别</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>bianma<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>获得数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">    bianhao=config.getServletContext().getInitParameter(<span class="string">"bianma"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="2-6-servlet3-0"><a href="#2-6-servlet3-0" class="headerlink" title="2.6 servlet3.0"></a>2.6 servlet3.0</h2><p>@WebServlet注解配置Servlet</p>
<p>从Servlet3.0开始，配置Servlet⽀持注解⽅式，但还是保留了配置web.xml⽅式，所有使⽤Servlet有两种⽅式：</p>
<p>（1）Servlet类上使⽤@WebServlet注解进⾏配置</p>
<p>（2）web.xml⽂件中配置</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210419015334.png" alt="image-20210419015334391" style="zoom:67%;" /></p>
<p>实例：以Demo1为例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet</span>(name = <span class="string">"myUserServlet"</span>,urlPatterns = <span class="string">"/user/test"</span>, <span class="comment">//斜杠必须</span></span><br><span class="line">            loadOnStartup = <span class="number">1</span>,</span><br><span class="line">            initParams = &#123;</span><br><span class="line">                <span class="meta">@WebInitParam</span>(name=<span class="string">"name"</span>, value=<span class="string">"⼩明"</span>),</span><br><span class="line">                <span class="meta">@WebInitParam</span>(name=<span class="string">"pwd"</span>, value=<span class="string">"123456"</span>)</span><br><span class="line">            &#125;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">7109220574468622594L</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.init(config);</span><br><span class="line">        System.out.println(<span class="string">"servlet初始化..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponseresponse)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">"utf-8"</span>);</span><br><span class="line">        PrintWriter pw = response.getWriter();</span><br><span class="line">        pw.append(<span class="string">"Hello Servlet!&lt;br&gt;"</span> );</span><br><span class="line">        <span class="comment">//servletName</span></span><br><span class="line">        pw.append(<span class="string">"servletName："</span> + getServletName() + <span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">        <span class="comment">//initParam</span></span><br><span class="line">        ServletConfig servletConfig = <span class="keyword">this</span>.getServletConfig();</span><br><span class="line">        Enumeration&lt;String&gt; paramNames = servletConfig.getInitParameterNames();</span><br><span class="line">        <span class="keyword">while</span> (paramNames.hasMoreElements()) &#123;</span><br><span class="line">        String paramName = paramNames.nextElement();</span><br><span class="line">        pw.append(paramName + <span class="string">"："</span> + servletConfig.getInitParameter(paramName) +</span><br><span class="line">        <span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        pw.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponseresponse)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>loadOnStartup：</strong></p>
<p>标记容器是否在启动应⽤时就加载Servlet，默认不配置或数值为负数时表示客户端第⼀次请求Servlet时再加载；</p>
<p>0或正数表示启动应⽤就加载，正数情况下，数值越⼩，加载该Servlet的优先级越⾼；</p>
<p>实例：<strong>//斜杠必须</strong></p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="constructor">WebServlet(<span class="params">value</span>=<span class="string">"/test1"</span>,<span class="params">loadOnStartup</span>=1)</span></span><br></pre></td></tr></table></figure>
<p><strong>urlPatterns：/斜杠必须(一定要加斜杠，切记切记)</strong></p>
<p>传入字符串表示对于该地址（href/action）的访问都可以用该类来接收，可以用<code>{&quot;&quot;，&quot;&quot;,&quot;}</code>的方式传入多个url</p>
<p><strong>name：</strong></p>
<p>可以指定也可以不指定，通过getServletName()可以获取到，若不指定，则为Servlet的完整类名，如：cn.edu.njit.servlet.UserServlet</p>
<p><strong>在使⽤注解⽅式时，需要注意：</strong></p>
<p>根元素中不能配置属性metadata-complete=”true”，否则⽆法加载Servlet。metadata-complete属性表示通知Web容器是否寻找注解，</p>
<p>默认不写或者设置false，容器会扫描注解，为Web应⽤程序构建有效的元数据；metadata-complete=”true”，会在启动时不扫描注解</p>
<p>（hannotation）。如果不扫描注解的话，⽤注解进⾏的配置就⽆法⽣效，例如：@WebServlet</p>
<p><strong>urlPatterns的常⽤规则：</strong><br>/<em>或者/：拦截所有
</em>.do：拦截指定后缀<br>/user/test：拦截路径<br>/user/.do、/.do、test*.do都是⾮法的，启动时候会报错</p>
<h1 id="3-JSP"><a href="#3-JSP" class="headerlink" title="3. JSP"></a>3. JSP</h1><h2 id="3-1-概念"><a href="#3-1-概念" class="headerlink" title="3.1 概念"></a>3.1 概念</h2><h3 id="什么是JSP？"><a href="#什么是JSP？" class="headerlink" title="什么是JSP？"></a>什么是JSP？</h3><p>JSP全名为Java Server Pages，中⽂名叫java服务器⻚⾯，其根本是⼀个简化的Servlet设计，它 是由Sun Microsystems公司倡导、许多公司参与⼀起建⽴的⼀种动态⽹⻚技术标准。JSP技术有点类似ASP技术，它是在传统的⽹⻚HTML⽂件(<em>.htm,</em>.html)中插⼊Java程序段(Scriptlet)和JSP标记(tag)，从⽽形成JSP⽂件，后缀名为(<em>.jsp)。 ⽤JSP开发的Web应⽤是跨平台的，既能在Linux下运⾏，也能在其他操作系统上运⾏。<br>JSP将⽹⻚逻辑与⽹⻚设计的显示分离，⽀持可重⽤的基于组件的设计，使基于Web的应⽤程序的开发变得迅速和容易。
</em>.html 静态⻚⾯(包含固定的⻚⾯内容)<br>*.jsp 动态⻚⾯(⻚⾯数据可以动态更新,⽀持嵌套java代码和html代码)</p>
<h3 id="JSP为什么会出现"><a href="#JSP为什么会出现" class="headerlink" title="JSP为什么会出现"></a>JSP为什么会出现</h3><ol>
<li>servlet展示信息的不⽅便，引⼊了JSP。</li>
<li>JSP本质上也是⼀个servlet！！！！！！</li>
<li>JSP就是在HTML⻚⾯中嵌⼊了java代码。</li>
</ol>
<h3 id="JSP中如何嵌套java代码"><a href="#JSP中如何嵌套java代码" class="headerlink" title="JSP中如何嵌套java代码"></a>JSP中如何嵌套java代码</h3><p>答案:⼩脚本(&lt;% java代码%&gt;)</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">声明标签 &lt;%!变量或者⽅法声明%&gt;</span><br><span class="line">表达式标签 &lt;%= 表达式%&gt; 在⻚⾯上显示的效果</span><br><span class="line">程序代码标签 &lt;%java代码%&gt; ⻚⾯上动态展示内容</span><br></pre></td></tr></table></figure>
<p>page指令:<br>&lt;%@ page language=”java” import=”java.util.*” pageEncoding=”UTF-8”%&gt;</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;%! <span class="keyword">int</span> i=<span class="number">10</span>;%&gt;&lt;!--成员变量--&gt;</span><br><span class="line">    &lt;%! <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;&#125;%&gt; &lt;!--成员⽅法--&gt;</span><br><span class="line">    &lt;%=i%&gt; &lt;!--输出变量值--&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p>如果把⼀个数据存在request域中，取值操作如下:</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210419034353.png" alt="image-20210419034353548"></p>
<p>jsp中的注释</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- html注释内容,查看源码时能看到 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%--</span> <span class="attr">jsp</span>注释,查看⻚⾯源码时看不到 <span class="attr">--</span>%&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="3-2-JSP的原理"><a href="#3-2-JSP的原理" class="headerlink" title="3.2  JSP的原理"></a>3.2  JSP的原理</h2><p><img src="https://gitee.com/biongd/img/raw/master/img/20210419213725.png" alt="image-20210419213718614"></p>
<p>当浏览器访问<a href="http://localhost:8080/test/index.jsp。服务器发现后缀为.jsp，它会根据路径找到index.jsp⽂件，会将index.jsp翻译成index_jsp.java⽂件，对这个java⽂件进⾏编译，产⽣⼀个index_jsp.class⽂件，将class⽂件加载运⾏。" target="_blank" rel="noopener">http://localhost:8080/test/index.jsp。服务器发现后缀为.jsp，它会根据路径找到index.jsp⽂件，会将index.jsp翻译成index_jsp.java⽂件，对这个java⽂件进⾏编译，产⽣⼀个index_jsp.class⽂件，将class⽂件加载运⾏。</a></p>
<p>此时在work文件夹中可以看到产生的java和class文件！！</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210419213941.png" alt="image-20210419213941543"></p>
<p>也就是说最终翻译成class，被虚拟机加载，本质就是servlet，拥有类似servlet中请求和响应的方法</p>
<p>响应回去就是把JSP中的HTML代码以流的⽅式写回浏览器。</p>
<h2 id="3-3-JSP内置对象"><a href="#3-3-JSP内置对象" class="headerlink" title="3.3 JSP内置对象"></a>3.3 JSP内置对象</h2><p>JSP中⼀共预先定义了9个这样的对象，分别为：request、response、session、application、out、pagecontext、config、page、exception</p>
<p>1、request对象</p>
<p>request 对象是 javax.servlet.httpServletRequest类型的对象。 该对象代表了客户端的请求信息，主要⽤于接受通过HTTP协议传送到服</p>
<p>务器的数据。（包括头信息、系统信息、请求⽅式以及请求参数等）。request对象的作⽤域为⼀次请求。</p>
<p>2、response对象</p>
<p>response 代表的是对客户端的响应，主要是将JSP容器处理过的对象传回到客户端。response对象也具有作⽤域，它只在JSP⻚⾯内有</p>
<p>效。所属类型:HttpServletResponse</p>
<p>3、session对象</p>
<p>session 对象是由服务器⾃动创建的与⽤户请求相关的对象。服务器为每个⽤户都⽣成⼀个session对象，⽤于保存该⽤户的信息，跟踪⽤</p>
<p>户的操作状态。session对象内部使⽤Map类来保存数据，因此保存数据的格式为 “Key/value”。 session对象的value可以使复杂的对象类</p>
<p>型，⽽不仅仅局限于字符串类型。HttpSession<br>4、application对象</p>
<p>application 对象可将信息保存在服务器中，直到服务器关闭，否则application对象中保存的信息会在整个应⽤中都有效。与session对象</p>
<p>相⽐，application对象⽣命周期更⻓，类似于系统的“全局变量”ServletContext</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">区别：</span><br><span class="line"><span class="symbol">request:</span>单次请求</span><br><span class="line"><span class="symbol">session:</span>浏览器访问期间(会话期间)</span><br><span class="line"><span class="symbol">application:</span>服务器启动期间,所存的数据可以跨浏览器</span><br><span class="line"><span class="symbol">pageContext:</span>单个页面内</span><br></pre></td></tr></table></figure>
<p>5、out 对象</p>
<p>out 对象⽤于在Web浏览器内输出信息，并且管理应⽤服务器上的输出缓冲区。在使⽤ out 对象输出数据时，可以对数据缓冲区进⾏操</p>
<p>作，及时清除缓冲区中的残余数据，为其他的输出让出缓冲空间。待数据输出完毕后，要及时关闭输出流。</p>
<p>示例:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">out.print("<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">'text/javascript'</span>&gt;</span><span class="actionscript">alert(<span class="string">'⽤户名不存在'</span>);location.href=<span class="string">'index.jsp'</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>");</span><br></pre></td></tr></table></figure>
<p>6、pageContext 对象</p>
<p>pageContext 对象的作⽤是取得任何范围的参数，通过它可以获取 JSP⻚⾯的out、request、reponse、session、application 等对象。</p>
<p>pageContext对象的创建和初始化都是由容器来完成的，在JSP⻚⾯中可以直接使⽤ pageContext对象。</p>
<p>7、config 对象</p>
<p>config 对象的主要作⽤是取得服务器的配置信息。通过 pageConext对象的 getServletConfig() ⽅法可以获取⼀个config对象。当⼀个</p>
<p>Servlet 初始化时，容器把某些信息通过config对象传递给这个Servlet。 开发者可以在web.xml ⽂件中为应⽤程序环境中的Servlet程序和</p>
<p>JSP⻚⾯提供初始化参数。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将image路径转换成服务器端的路径</span></span><br><span class="line">String url= config.getServletContext().getRealPath(<span class="string">"/image"</span>);</span><br><span class="line">&lt;h1&gt;url=&lt;%=url %&gt;&lt;/h1&gt;</span><br></pre></td></tr></table></figure>
<p>8、page 对象</p>
<p>page 对象代表JSP本身，只有在JSP⻚⾯内才是合法的。 page隐含对象本质上包含当前 Servlet接⼝引⽤的变量，类似于Java编程中的 this </p>
<p>指针。<br>9、exception 对象<br>exception 对象的作⽤是显示异常信息，只有在包含 isErrorPage=”true” 的⻚⾯中才可以被使⽤，在⼀般的JSP⻚⾯中使⽤该对象将⽆法编译JSP⽂件。excepation对象和Java的所有对象⼀样，都具有系统提供的继承结构。exception 对象⼏乎定义了所有异常情况。在Java程序中，可以使⽤try/catch关键字来处理异常情况； 如果在JSP⻚⾯中出现没有捕获到的异常，就会⽣成 exception 对象，并把exception 对象传送到在page指令中设定的错误⻚⾯中，然后在错误⻚⾯中处理相应的 exception 对象。<br>(1)先在可能发⽣错误的⻚⾯中添加errorPage属性:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@<span class="built_in"> page </span><span class="attribute">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attribute">language</span>=<span class="string">"java"</span> <span class="attribute">errorPage</span>=<span class="string">"test1.jsp"</span> %&gt;</span><br></pre></td></tr></table></figure>
<p>(2) 在error.jsp⻚⾯中设置isErrorPage=”true” 的属性(使⽤exception对象之前，需要先将当前⻚⾯设置成错误⻚⾯）</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@<span class="built_in"> page </span><span class="attribute">contentType</span>=<span class="string">"text/html;charset=UTF-8"</span> <span class="attribute">language</span>=<span class="string">"java"</span> <span class="attribute">isErrorPage</span>=<span class="string">"true"</span> %&gt;</span><br></pre></td></tr></table></figure>
<h3 id="request，session，application，pageContext四种数据存储对象的区别："><a href="#request，session，application，pageContext四种数据存储对象的区别：" class="headerlink" title="request，session，application，pageContext四种数据存储对象的区别："></a>request，session，application，pageContext四种数据存储对象的区别：</h3><p>test页面：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">   &lt;%<span class="comment">//作用域为一次请求%&gt;</span></span><br><span class="line">   &lt;%request.setAttribute(<span class="string">"a1"</span>,<span class="string">"aaa"</span>);%&gt;</span><br><span class="line">   request=&lt;%=request.getAttribute(<span class="string">"a1"</span>)%&gt;&lt;br/&gt;</span><br><span class="line">   &lt;% <span class="comment">//作用域为浏览器访问期间%&gt;</span></span><br><span class="line">   &lt;%</span><br><span class="line">       session.setAttribute(<span class="string">"b1"</span>,<span class="string">"bbb"</span>);</span><br><span class="line">   %&gt;</span><br><span class="line">   session=&lt;%=session.getAttribute(<span class="string">"b1"</span>)%&gt;&lt;br/&gt;</span><br><span class="line">   &lt;%<span class="comment">//作用域为服务器运行期间，类似于全局变量ServletContext%&gt;</span></span><br><span class="line">   &lt;%</span><br><span class="line">       application.setAttribute(<span class="string">"c1"</span>,<span class="string">"ccc"</span>);</span><br><span class="line">   %&gt;</span><br><span class="line">   application =&lt;%=application.getAttribute(<span class="string">"c1"</span>)%&gt;&lt;br/&gt;</span><br><span class="line">   &lt;%<span class="comment">//作用域为当前网页%&gt;</span></span><br><span class="line">   &lt;%</span><br><span class="line">       pageContext.setAttribute(<span class="string">"d1"</span>,<span class="string">"ddd"</span>);</span><br><span class="line">   %&gt;</span><br><span class="line">   pageContext=&lt;%=pageContext.getAttribute(<span class="string">"d1"</span>)%&gt;&lt;br/&gt;</span><br><span class="line">&lt;a href="test1.jsp"&gt;test1.jsp&lt;/a&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210419222810.png" alt="image-20210419222810007"></p>
<p>test1页面：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="comment">//作用域为一次请求%&gt;</span></span><br><span class="line">request=&lt;%=request.getAttribute(<span class="string">"a1"</span>)%&gt;&lt;br/&gt;</span><br><span class="line">&lt;% <span class="comment">//作用域为浏览器访问期间%&gt;</span></span><br><span class="line">session=&lt;%=session.getAttribute(<span class="string">"b1"</span>)%&gt;&lt;br/&gt;</span><br><span class="line">&lt;%<span class="comment">//作用域为服务器运行期间，类似于全局变量ServletContext%&gt;</span></span><br><span class="line">application =&lt;%=application.getAttribute(<span class="string">"c1"</span>)%&gt;&lt;br/&gt;</span><br><span class="line">&lt;%<span class="comment">//作用域为当前网页%&gt;</span></span><br><span class="line">pageContext=&lt;%=pageContext.getAttribute(<span class="string">"d1"</span>)%&gt;&lt;br/&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210419222837.png" alt="image-20210419222837352"></p>
<p>可以明显看出跳转页面后，只有session和application的数据还能够有效访问，当切换浏览器进行访问test1.jsp时，同样无法获取session的值！！</p>
<h2 id="3-4-JSP的指令"><a href="#3-4-JSP的指令" class="headerlink" title="3.4 JSP的指令"></a>3.4 JSP的指令</h2><p>JSP指令⽤来设置整个JSP⻚⾯相关的属性，如⽹⻚的编码⽅式和脚本语⾔。语法格式如下：</p>
<p><code>&lt;%@ directive attribute=&quot;value&quot; %&gt;</code> </p>
<p><code>directive：指令名称 attribute 属性名 value:属性值</code></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210419225751.png" alt="image-20210419225751630"></p>
<h3 id="3-4-1-Page指令"><a href="#3-4-1-Page指令" class="headerlink" title="3.4.1 Page指令"></a>3.4.1 Page指令</h3><p>Page指令为容器提供当前⻚⾯的使⽤说明⼀个JSP⻚⾯可以包含多个page指令<br>语法格式：<br><code>&lt;%@ page attribute=&quot;value&quot; %&gt;</code></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210419225859.png" alt="image-20210419225859091"></p>
<h3 id="3-4-2-include指令"><a href="#3-4-2-include指令" class="headerlink" title="3.4.2 include指令"></a>3.4.2 include指令</h3><p>JSP可以通过include指令来包含其他⽂件。被包含的⽂件可以是JSP⽂件、HTML⽂件或⽂本⽂件。包含的⽂件就好像是该JSP⽂件的⼀部分，会被同时编译执⾏。(类似于html中的frameset或者iFrame标签)</p>
<p>语法格式：</p>
<p><code>&lt;%@ include file=&quot;⽂件相对 url 地址&quot; %&gt;</code></p>
<p>include 指令中的⽂件名实际上是⼀个相对的 URL 地址。如果您没有给⽂件关联⼀个路径，JSP编译器默认在当前路径下寻找。</p>
<h3 id="3-4-3-Taglib指令"><a href="#3-4-3-Taglib指令" class="headerlink" title="3.4.3 Taglib指令"></a>3.4.3 Taglib指令</h3><p>JSP API允许⽤户⾃定义标签，⼀个⾃定义标签库就是⾃定义标签的集合。<br>Taglib指令引⼊⼀个⾃定义标签集合的定义，包括库路径、⾃定义标签</p>
<p>格式：</p>
<p><code>&lt;%@ taglib uri=&quot;uri&quot; prefix=&quot;&quot; %&gt;</code></p>
<p>uri属性确定标签库的位置，prefix属性指定标签库的前缀(可⾃定义)。</p>
<h2 id="3-5-JSP出现的状态码"><a href="#3-5-JSP出现的状态码" class="headerlink" title="3.5 JSP出现的状态码"></a>3.5 JSP出现的状态码</h2><p>每一次请求和响应都会有一个状态码，是对操作结果的一个数值型标记，可以帮助我们找出错误</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210419231751.png" alt="image-20210419231751653"></p>
<h2 id="3-6-EL表达式"><a href="#3-6-EL表达式" class="headerlink" title="3.6 EL表达式"></a>3.6 EL表达式</h2><p>实际开发中并不会用小脚本的方式！！也就是不会让显示部分和逻辑代码嵌套，逻辑部分还是交由后台执行，这里的EL表达式和下面的JSTL都是为了简化显示。</p>
<p><strong>什么是Expression Language 表达式语⾔？</strong></p>
<p>最初定义于JSTL1.0部分</p>
<p>在JSP2.0中，EL从JSTL中剥离出来，放置在JSP规范中，称为JSP2.0规范的⼀部分</p>
<p>在JSP中使⽤EL表达式，可以简化对象和变量的访问是EL表达式</p>
<p><strong>EL表达式语法</strong>：</p>
<p>语法格式：<code>${需要展示信息的名字}</code></p>
<p>注意：</p>
<ul>
<li><p>无法显示定义的变量，想要读取变量，该变量一定要保存在作用域中</p>
</li>
<li><p>当表达式没有指定变量或者对象的范围时，那么容器会依次从pageContext—&gt;request—&gt;session—&gt;application中查找该变量或对象，我们可以通过隐含对象获得指定作⽤域的值:</p>
</li>
</ul>
<p>对于集合和多个域有相同key值的取值？</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; l = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line">pageContext.setAttribute(<span class="string">"a1"</span>, a);</span><br><span class="line">l.add(<span class="string">"a"</span>);</span><br><span class="line">l.add(<span class="string">"b"</span>);</span><br><span class="line">pageContext.setAttribute(<span class="string">"a2"</span>, l);</span><br><span class="line">Map&lt;String,String&gt; m = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">m.put(<span class="string">"today"</span>,<span class="string">"今天天气不错"</span>);</span><br><span class="line">pageContext.setAttribute(<span class="string">"a3"</span>,m);</span><br><span class="line">pageContext.setAttribute(<span class="string">"a4"</span>, <span class="string">"pageContext内容"</span>);</span><br><span class="line">request.setAttribute(<span class="string">"a4"</span>, <span class="string">"request内容"</span>);</span><br><span class="line">session.setAttribute(<span class="string">"a4"</span>, <span class="string">"session内容"</span>);</span><br><span class="line">application.setAttribute(<span class="string">"a4"</span>, <span class="string">"application内容"</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;20</span>&lt;30? <span class="string">"aaa"</span>:<span class="string">"bbb"</span>&#125;</span><br><span class="line">a = <span class="variable">$&#123;a&#125;</span>&lt;<span class="keyword">br</span>&gt;</span><br><span class="line">a = <span class="variable">$&#123;a1&#125;</span>&lt;<span class="keyword">br</span>&gt;</span><br><span class="line">a = <span class="variable">$&#123;a2</span>[1]&#125;&lt;<span class="keyword">br</span>&gt;</span><br><span class="line">key = <span class="variable">$&#123;a3</span>.today&#125;</span><br><span class="line">session-a4 = <span class="variable">$&#123;sessionScope</span>.a4&#125;</span><br><span class="line">a4 = <span class="variable">$&#123;a4&#125;</span></span><br></pre></td></tr></table></figure>
<p>显示结果：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">this is top</span><br><span class="line">this is middle</span><br><span class="line">this is bottom</span><br><span class="line">50</span><br><span class="line"><span class="literal">false</span></span><br><span class="line"><span class="literal">true</span></span><br><span class="line">aaa a =</span><br><span class="line">a = 10</span><br><span class="line">a = b</span><br><span class="line">key = 今天天气不错 session-a4 = session内容 a4 = pageContext内容</span><br></pre></td></tr></table></figure>
<p><strong>EL中基础操作符:</strong></p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210420233833.png" alt="image-20210420233833236" style="zoom:67%;" /></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">判断变量是否有值或是否存在:<span class="variable">$&#123;empty key值&#125;</span></span><br><span class="line">List <span class="attribute">list2</span>=new ArrayList();</span><br><span class="line">list2.<span class="builtin-name">add</span>(<span class="string">"aa"</span>);</span><br><span class="line">request.setAttribute(<span class="string">"list222"</span>,list2);</span><br><span class="line">判断list中是否有数据:<span class="variable">$&#123;empty list222&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="3-7-JSTL"><a href="#3-7-JSTL" class="headerlink" title="3.7 JSTL"></a>3.7 JSTL</h2><p><strong>一：什么是JSTL?</strong></p>
<p>JSP标准标签库（JSTL）是⼀个JSP标签集合，它封装了JSP应⽤的通⽤核⼼功能。</p>
<p>JSTL⽀持通⽤的、结构化的任务，⽐如迭代，条件判断，XML⽂档操作，国际化标签，SQL标签。 除了这些，它还提供了⼀个框架来使⽤集成JSTL的⾃定义标签。</p>
<p>根据JSTL标签所提供的功能，可以将其分为5个类别。核⼼标签 格式化标签 sql标签 xml标签 jstl函数</p>
<p><strong>二：JSTL的作⽤和语法格式：</strong></p>
<p>作⽤：简化jsp⻚⾯编写代码</p>
<p><strong>语法格式：</strong></p>
<ol>
<li>下载 jakarta-taglibs-standard-1.1.2.zip 包并解压，将 jakarta-taglibs-standard-1.1.2/lib/ 下的两个 jar ⽂件：standard.jar 和 jstl.jar ⽂件拷⻉到 /WEB-INF/lib/ 下。</li>
<li><p>在JSP⻚⾯中引⼊&lt;%@ taglib prefix=”⻚⾯使⽤的名称” uri=”功能范围的路径”%&gt;</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210421000911.png" alt="image-20210421000911845"></p>
</li>
</ol>
<p><strong>三：核⼼标签</strong></p>
<p>核⼼标签是最常⽤的 JSTL标签。引⽤核⼼标签库的语法如下：</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="meta">%</span>@ taglib prefix=<span class="string">"c"</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> <span class="meta">%</span>&gt;</span><br></pre></td></tr></table></figure>
<p>核⼼标签的分类</p>
<ul>
<li><p>表达式操作： <code>out、set、remove、catch</code></p>
</li>
<li><p>流程控制：<code>if、choose、when、otherwise</code></p>
</li>
<li><p>迭代操作：<code>forEach、forTokens</code></p>
</li>
<li><p>URL操作：<code>import、param、url、redirect</code></p>
</li>
<li><p>Set标签<br>＜c:set&gt; 主要⽤来将变量存储⾄JSP范围中 或是JavaBean的属性或Map对象中</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210421001757.png" alt="image-20210421001757369" style="zoom:67%;" /></p>
<p>＜c:out&gt;主要⽤来显示数据的内容</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210421001833.png" alt="image-20210421001833627" style="zoom:67%;" /></p>
<p>＜c:remove&gt; 主要负责移除变量</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210421001912.png" alt="image-20210421001912043" style="zoom:67%;" /></p>
<p>＜c:if&gt; 主要⽤于进⾏if判断,如果为true,则输出标签体中的内容</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210421001948.png" alt="image-20210421001948836" style="zoom:67%;" /></p>
<p>＜c:choose&gt;,＜c:when&gt;,＜c:otherwise&gt; 作⽤相当于if-else</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210421002019.png" alt="image-20210421002019812" style="zoom:50%;" /></p>
<p>＜c:forEach&gt; 循环控制，它可以将数组,集合(Collection)中的成员循序浏览⼀遍</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210421002052.png" alt="image-20210421002052717" style="zoom:67%;" /></p>
</li>
</ul>
<p>格式化标签</p>
<ol>
<li><p>fmt:formatDate 作⽤：将⽇期类型格式化为指定模式的字符串属性</p>
<p>value:将要被格式化的数据</p>
<p>pattern：格式化的模式，与SimpleDateFormat的参数设置⼀样</p>
<p>var:格式化后的字符串所要存放的变量，若不指定var，则会将格式化的结果直接显示在⻚⾯</p>
<p>scope：变量存放的域属性空间，默认page</p>
<p>type：其取值为date、time、both，表示给出的value是⽇期、时间、还是两者都包含，默认是date</p>
</li>
<li><p>fmt:parseDate 作⽤：⽤于将指定字符串转化为⽇期类型</p>
<p><code>&lt;fmt:parseDate value=&quot;${now }&quot; pattern=&quot;yyyy-MM-dd&quot; var=&quot;today&quot;/&gt;</code></p>
<p>Value服务器获取的时间</p>
<p>Pattern:转换的格式</p>
<p>Var:⻚⾯显示的变量</p>
</li>
<li><p>fmt:formatNumber 按照指定格式对数字进⾏格式化属性</p>
<p>maxIntegerDigits：整数部分最多的位数</p>
<p>minIntegerDigits：整数部分最少的位数</p>
<p>maxFrctionDigits：⼩数部分最多的位数</p>
<p>minFrctionDigits：⼩数部分最少的位数</p>
<p>var：存储格式化结果的变量</p>
<p>scope：var属性的作⽤域</p>
<p>integerOnly：是否只解析整型数true或者浮点数false</p>
</li>
</ol>
<h1 id="4-session和cookie"><a href="#4-session和cookie" class="headerlink" title="4. session和cookie"></a>4. session和cookie</h1><p><strong>什么是会话跟踪技术</strong></p>
<p>会话跟踪是Web程序中常⽤的技术，⽤来跟踪⽤户的整个会话。保持对⽤户会话期间的数据管理。常⽤的会话跟踪技术是Cookie与Session。</p>
<ul>
<li>Cookie通过在客户端记录信息确定⽤户身份</li>
<li>Session通过在服务器端记录信息确定⽤户身份。</li>
</ul>
<h2 id="4-1-cookie"><a href="#4-1-cookie" class="headerlink" title="4.1 cookie"></a>4.1 cookie</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><ul>
<li><p>Cookie是客户端(⼀般指浏览器)请求服务器后,服务器发给客户端的⼀个辨认标识，保存在客户端，当客户端再次向服务器发送请求时，会携带着这个辨认标识，服务器就可以通过这个标识来识别客户端的身份或状态等。</p>
</li>
<li><p>Cookie的作⽤：</p>
<p>跟踪会话，记录⼀次会话中(即Session，⼀次会话可能会有多次请求，当然也可以有多个Cookie来跟踪不同的信息)的信息，这样服务器就会知道⽤户的状态，⽐如有没有登录成功，付款时购物⻋中的东⻄等，就相当于贴在客户端脑⻔上的纸条，浏览器看不到，但服务器看得到。</p>
</li>
</ul>
<p>注意：不同浏览器存储的cookie内容不同，解析方式也不同</p>
<h3 id="Cookie的应⽤"><a href="#Cookie的应⽤" class="headerlink" title="Cookie的应⽤"></a>Cookie的应⽤</h3><ul>
<li><p>保持⽤户登录状态</p>
<p>将⽤户的信息保存到Cookie中，并发送给浏览器，并且将有效时间设置为⼀个较⻓的时间，这样浏览器在以后访问⽹站时，都会带着该Cookie，服务器以此来辨识⽤户，⽤户就不再需要输⼊⽤户名和密码等信息。</p>
</li>
<li><p>记录⽤户名</p>
<p>⼀旦⽤户登录成功以后，下次再登录时，直接将Cookie中的⽤户名读取并显示出来，这样⽤户就不需要再次输⼊⽤户名，只输⼊密码即可。</p>
</li>
</ul>
<h3 id="Cookie的设置和获取"><a href="#Cookie的设置和获取" class="headerlink" title="Cookie的设置和获取"></a>Cookie的设置和获取</h3><ul>
<li><p>通过HttpServletResponse.addCookie的⽅式设置Cookie</p>
<p>注意:new Cookie()时两个参数都是字符串</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"jieguo"</span>,<span class="string">"true"</span>);</span><br><span class="line">response.addCookie(cookie);</span><br></pre></td></tr></table></figure>
</li>
<li><p>浏览器中查看cookie的内容：</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210421122914.png" alt="image-20210421122907388"></p>
</li>
<li><p>服务端获取客户端携带的cookie：通过HttpServletRequest获取</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    Cookie[] cookies = request.getCookies();</span><br><span class="line">    <span class="keyword">if</span>(cookies != <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">for</span>(Cookie c : cookies)&#123;</span><br><span class="line">            String name = c.getName();<span class="comment">//获取Cookie名称</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="string">"jieguo"</span>.equals(name))&#123;</span><br><span class="line">            String value = c.getValue();<span class="comment">//获取Cookie的值</span></span><br><span class="line">            bool = Boolean.valueOf(value);<span class="comment">//将值转为Boolean类型</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="删除Cookie"><a href="#删除Cookie" class="headerlink" title="删除Cookie"></a>删除Cookie</h3><ul>
<li><p>立即失效</p>
<p>通过设置同名Cookie的最⼤存活时间为0，删除Cookie是指使浏览器不再保存Cookie，使Cookie⽴即失<br>效<br>举例：使name为username的Cookie⽴即失效</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建⼀个name为username的Cookie</span></span><br><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"username"</span>, <span class="string">"aaa"</span>);</span><br><span class="line"><span class="comment">//2.设置Cookie的有效时间为0</span></span><br><span class="line">cookie.setMaxAge(<span class="number">0</span>);<span class="comment">//删除cookie的关键</span></span><br><span class="line"><span class="comment">//3.将cookie发送给浏览器，来替换同名Cookie</span></span><br><span class="line">response.addCookie(cookie);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Cookie的有效时间<br>Cookie发送给浏览器以后，浏览器并不会永久保存，也就是到了⼀定的时间以后浏览器会⾃动销毁Cookie。Cookie的默认有效时间为⼀次会话(⼀次打开关闭浏览器的过程)，我们也可以⼿动指定Cookie的有效时间</p>
<p><strong>实例：</strong>126邮箱在登录时可以选择10天免登录</p>
</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//setMaxAge⽤来设置Cookie的最⼤有效时间，需要int型的参数，代表有效的秒数</span></span><br><span class="line">cookie.setMaxAge(秒数)；</span><br><span class="line"><span class="comment">//当参数⼤于0时，会设置为指定的秒数</span></span><br><span class="line">cookie.setMaxAge(<span class="number">30</span>);</span><br><span class="line"><span class="comment">//当参数等于0时,浏览器不会保存Cookie,Cookie⽴即失效</span></span><br><span class="line">cookie.setMaxAge(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//当参数⼩于0时，和不设置是⼀样，当前会话有效</span></span><br><span class="line">cookie.setMaxAge(<span class="number">-100</span>);</span><br><span class="line"><span class="comment">//设置⼀个永久有效的Cookie，并⾮永久，只是使Cookie的⽣命很⻓⽽已</span></span><br><span class="line">cookie.setMaxAge(<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">365</span>*<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<h2 id="4-2-session"><a href="#4-2-session" class="headerlink" title="4.2 session"></a>4.2 session</h2><h3 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h3><ul>
<li><p>Session是另⼀种记录客户状态的机制，不同的是Cookie保存在客户端浏览器中，⽽Session保存在服务器上。客户端浏览器访问服务器的时候，服务器把客户端信息以某种形式记录在服务器上。这就是Session。客户端浏览器再次访问时只需要从该Session中查找该客户的状态就可以了。如果说Cookie机制是通过检查客户身上的“通⾏证”来确定客户身份的话，那么Session机制就是通过检查服务器上的“客户明细表”来确认客户身份。Session相当于程序在服务器上建⽴的⼀份客户档案，客户来访的时候只需要查询客户档案表就可以了。</p>
<p>需要注意：session持续占用服务器资源，不能随便用</p>
</li>
</ul>
<h3 id="创建Session的格式"><a href="#创建Session的格式" class="headerlink" title="创建Session的格式"></a>创建Session的格式</h3><p>Session对应的类为javax.servlet.http.HttpSession类。每个来访者对应⼀个Session对象，所有该客户的状态信息都保存在这Session对象⾥。Session对象是在客户端第⼀次请求服务器的时候创建的。</p>
<p>Session也是⼀种key-value的属性对，通过getAttribute(Stringkey)和setAttribute(String key，Objectvalue)⽅法读写客户状态信息。Servlet⾥通过request.getSession()⽅法获取该客户的 Session</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HttpSession session = request.getSession(); <span class="comment">// 获取Session对象</span></span><br><span class="line">session.setAttribute(<span class="string">"loginTime"</span>, <span class="keyword">new</span> Date()); <span class="comment">// 设置Session中的属性</span></span><br><span class="line">out.println(<span class="string">"登录时间为："</span> +(Date)session.getAttribute(<span class="string">"loginTime"</span>)); <span class="comment">// 获取Session属性</span></span><br></pre></td></tr></table></figure>
<h3 id="Session的⽣命周期"><a href="#Session的⽣命周期" class="headerlink" title="Session的⽣命周期"></a>Session的⽣命周期</h3><p>Session保存在服务器端。为了获得更⾼的存取速度，服务器⼀般把Session放在内存⾥。每个⽤户都会有⼀个独⽴的Session。<strong>如果</strong></p>
<p><strong>Session内容过于复杂，当⼤量客户访问服务器时可能会导致内存溢出。因此，Session⾥的信息应该尽量精简。</strong></p>
<ul>
<li><p>产生：</p>
<p>Session在⽤户第⼀次访问服务器的时候⾃动创建。<strong>需要注意只有访问JSP、Servlet等程序时才会创建Session</strong>，只访问HTML、IMAGE等静态资源并不会创建Session。如果尚未⽣成Session，也可以使request.getSession(true)强制⽣成Session。</p>
</li>
<li><p>如何失效</p>
<p>Session⽣成后，只要⽤户继续访问，服务器就会更新Session的最后访问时间，并维护该Session。⽤户每访问服务器⼀次，⽆论是否读写Session，服务器都认为该⽤户的Session“活跃（active）”了⼀次。由于会有越来越多的⽤户访问服务器，因此Session也会越来越多。</p>
<p><strong>为防⽌内存溢出，服务器会把⻓时间内没有活跃的Session从内存删除。</strong>这个时间就是<strong>Session的超时时间</strong>。如果超过了超时时间没访问过服务器，Session就⾃动失效了。</p>
<p><strong>获取、修改有效时间：</strong></p>
<p>Session的超时时间为maxInactiveInterval属性，可以通过对应的<code>getMaxInactiveInterval()</code>获取，通过<code>setMaxInactiveInterval(longinterval)</code>修改。<br>Session的超时时间也可以在web.xml中修改。另外，通过调⽤Session的invalidate()⽅法可以使Session失效。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">session-config</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>30<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">session-config</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>直接注销session</p>
<p><code>invalidate()</code></p>
</li>
</ul>
<h3 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h3><p><img src="https://gitee.com/biongd/img/raw/master/img/20210421140851.png" alt="image-20210421140851558" style="zoom:80%;" /></p>
<h3 id="Session和Cookie的区别"><a href="#Session和Cookie的区别" class="headerlink" title="Session和Cookie的区别"></a>Session和Cookie的区别</h3><ul>
<li>Cookie数据保存在客户端，Session数据保存在服务器端。</li>
<li><font color="red">Session是由应⽤服务器维持的⼀个服务器端的存储空间，⽤户在连接服务器时，会由服务器⽣成⼀个唯⼀的SessionID,⽤该SessionID 为标识符来存取服务器端的Session存储空间。⽽SessionID这⼀数据则是保存到客户端，⽤Cookie保存的，⽤户提交⻚⾯时，会将这⼀SessionID提交到服务器端，来存取Session数据。这⼀过程，是不⽤开发⼈员⼲预的。**所以⼀旦客户端禁⽤Cookie，那么Session也会失效。**</font>
</li>
<li><p>Cookies是属于Session对象的⼀种。但有不同，Cookies不会占服务器资源，是存在客服端内存或者⼀个Cookie的⽂本⽂件中；⽽Session则会占⽤服务器资源。所以，尽量不要使⽤Session，⽽使⽤Cookies。但是我们⼀般认为Cookie是不可靠的，Cookies是保存在本机上的，但是其信息的完全可⻅性且易于本地编辑性，往往可以引起很多的安全问题Session是可靠地。但是⽬前很多著名的站点也都⽤Cookie。</p>
</li>
</ul>
<h1 id="5-过滤器-Filter-和监听器（Listener）"><a href="#5-过滤器-Filter-和监听器（Listener）" class="headerlink" title="5. 过滤器(Filter)和监听器（Listener）"></a>5. 过滤器(Filter)和监听器（Listener）</h1><h2 id="5-1-Filter"><a href="#5-1-Filter" class="headerlink" title="5.1 Filter"></a>5.1 Filter</h2><h3 id="概念-2"><a href="#概念-2" class="headerlink" title="概念"></a>概念</h3><p>过滤器实际上就是对web资源进⾏拦截，做⼀些处理后再交给下⼀个过滤器或servlet处理，通常都是⽤来拦截request进⾏处理的，也可以对返回的response进⾏拦截处理</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210421142948.png" alt="image-20210421142948852" style="zoom:80%;" /></p>
<h3 id="过滤器的语法格式："><a href="#过滤器的语法格式：" class="headerlink" title="过滤器的语法格式："></a>过滤器的语法格式：</h3><ul>
<li><p>创建⼀个类实现Filter接⼝</p>
<p>public class CharSetFilter implements Filter{}`</p>
</li>
<li><p>重写接⼝中的⽅法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123; <span class="comment">//销毁的⽅法&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse resp, FilterChain chain)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="comment">//过滤⽅法 主要是对request和response进⾏⼀些处理，然后交给下⼀个过滤器或Servlet处理</span></span><br><span class="line">    <span class="comment">//有过滤器走过滤器，没有过滤器走servlet</span></span><br><span class="line">    System.out.println(<span class="string">"过滤器开始"</span>);</span><br><span class="line">    <span class="comment">//调取下一个过滤器</span></span><br><span class="line">    filterChain.doFilter(servletRequest,servletResponse);</span><br><span class="line">    System.out.println(<span class="string">"过滤器结束"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">    <span class="comment">/*初始化⽅法 接收⼀个FilterConfig类型的参数 该参数是对Filter的⼀些配置*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在web.xml⽂件中配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>过滤器名称<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>过滤器所在的路径<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>过滤器名称<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>需要过滤的资源<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>实例：</p>
<ul>
<li><p>单个过滤器执行结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">过滤器开始</span><br><span class="line">aaa  <span class="comment">//这是执行了servlet中的打印方法</span></span><br><span class="line">过滤器结束</span><br></pre></td></tr></table></figure>
</li>
<li><p>两个过滤器的执行结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//先执行过滤器1</span></span><br><span class="line">过滤器开始</span><br><span class="line"><span class="comment">//执行到filterChain.doFilter(servletRequest,servletResponse);启动第二个过滤器</span></span><br><span class="line">过滤器<span class="number">2</span>开始</span><br><span class="line"><span class="comment">//执行到filterChain.doFilter(servletRequest,servletResponse);没有第三个过滤器，执行servlet</span></span><br><span class="line">aaa</span><br><span class="line">过滤器<span class="number">2</span>结束</span><br><span class="line">过滤器结束</span><br></pre></td></tr></table></figure>
<p>注意：两个过滤器执行的先后顺序由xml配置的先后顺序决定！！</p>
</li>
</ul>
<h3 id="过滤器的使用场合"><a href="#过滤器的使用场合" class="headerlink" title="过滤器的使用场合"></a>过滤器的使用场合</h3><ul>
<li><p>如何防⽌⽤户未登录就执⾏后续操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">    <span class="comment">//防止未登录访问</span></span><br><span class="line">    String requestURI = req.getRequestURI();<span class="comment">//获得请求地址</span></span><br><span class="line">    System.out.println(<span class="string">"requestURL="</span>+requestURI);</span><br><span class="line">    Object username= req.getSession().getAttribute(<span class="string">"username"</span>);</span><br><span class="line">    <span class="keyword">if</span>(requestURI.endsWith(<span class="string">"testsession.jsp"</span>)&amp;&amp;username==<span class="keyword">null</span>)&#123;</span><br><span class="line">        resp.sendRedirect(<span class="string">"index.jsp"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置编码⽅式—统⼀设置编码</p>
<p>如果需要对所有servlet都执行编码操作，只要把xml中的<code>url-Partten</code>中的/login改为/*</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public void <span class="keyword">do</span><span class="constructor">Filter(ServletRequest <span class="params">servletRequest</span>, ServletResponse <span class="params">servletResponse</span>, FilterChain <span class="params">filterChain</span>)</span> throws IOException, ServletException &#123;</span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"过滤器开始"</span>);</span><br><span class="line">    HttpServletRequest req= (HttpServletRequest)servletRequest;</span><br><span class="line">    req.set<span class="constructor">CharacterEncoding(<span class="string">"utf-8"</span>)</span>;</span><br><span class="line">    <span class="comment">//调取下一个过滤器</span></span><br><span class="line">    filterChain.<span class="keyword">do</span><span class="constructor">Filter(<span class="params">servletRequest</span>,<span class="params">servletResponse</span>)</span>;</span><br><span class="line">    <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(<span class="string">"过滤器结束"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>加密解密(密码的加密和解密)</p>
</li>
<li><p>⾮法⽂字筛选</p>
</li>
<li><p>下载资源的限制<br>过滤器的特点:在servlet之前和之后都会被执⾏</p>
</li>
</ul>
<h2 id="5-2-Listener"><a href="#5-2-Listener" class="headerlink" title="5.2 Listener"></a>5.2 Listener</h2><h3 id="概念-3"><a href="#概念-3" class="headerlink" title="概念"></a>概念</h3><p>监听器就是监听某个域对象的的状态变化的组件</p>
<p>监听器的相关概念：</p>
<ul>
<li><p>事件源：被监听的对象(三个域对象 request、session、servletContext)</p>
</li>
<li><p>监听器：监听事件源对象事件源对象的状态的变化都会触发监听器</p>
</li>
<li><p>注册监听器：将监听器与事件源进⾏绑定</p>
</li>
<li><p>响应⾏为：监听器监听到事件源的状态变化时所涉及的功能代码（程序员编写代码）</p>
</li>
</ul>
<p>监听器分类：</p>
<p>第⼀维度按照被监听的对象划分：ServletRequest域、HttpSession域、ServletContext域</p>
<p>第⼆维度按照监听的内容分：监听域对象的创建与销毁的、监听域对象的属性变化的</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210421152453.png" alt="image-20210421152453782"></p>
<h3 id="监听三⼤域对象的创建与销毁的监听器"><a href="#监听三⼤域对象的创建与销毁的监听器" class="headerlink" title="监听三⼤域对象的创建与销毁的监听器"></a>监听三⼤域对象的创建与销毁的监听器</h3><p>监听器的编写步骤（重点）：</p>
<ul>
<li>编写⼀个监听器类去实现监听器接⼝</li>
<li>覆盖监听器的⽅法</li>
<li>需要在web.xml中进⾏配置—注册</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>com.java.AttributeListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>常用监听器接口</p>
<ul>
<li><p>ServletContextListener</p>
<p>监听ServletContext域的创建与销毁的监听器</p>
<p>Servlet域的⽣命周期<br>何时创建：服务器启动创建<br>何时销毁：服务器关闭销毁</p>
<p>ServletContextListener监听器的主要作⽤<br>初始化的⼯作：初始化对象、初始化数据（加载数据库驱动、连接池的初始化）加载⼀些初始化的配置⽂件(spring的配置⽂件）<br>任务调度(定时器—Timer/TimerTask）</p>
</li>
<li><p>HttpSessionListener<br>监听Httpsession域的创建和销毁的监听器<br>HttpSession对象的⽣命周期<br>何时创建：第⼀次调⽤request.getSession时创建<br>何时销毁：服务器关闭销毁、session过期（默认30分钟，修改默认的30分钟是在Tomcat的web.xml，修改当前项⽬的过期时间是在⾃⼰项⽬的web.xml中）、⼿动销毁</p>
<p>HttpSessionListener监听器的主要作⽤：<br>由于每次访问⽹站都会默认创建session对象（jsp⻚⾯中page指令中的session属性默认为true，即被访问时创建session），可以⽤于计数⽹站访问过的⼈</p>
</li>
<li><p>ServletRequestListener<br>监听ServletRequest域创建与销毁的监听器</p>
</li>
</ul>
<h1 id="6-MVC"><a href="#6-MVC" class="headerlink" title="6. MVC"></a>6. MVC</h1><p>写Java Web项⽬时会发现，⼀个中型或者⼤型项⽬随着代码的增多，会发现：代码既可以写在src⽬录<br>下，也可以写在WebContent⽬录下。src下可以建很多包 ，WebContent下可以建很多⽂件夹。</p>
<p>所以问题就来了：</p>
<blockquote>
<p>⼀个新的类到底往哪个⽬录下的哪个⽂件夹⾥写？</p>
</blockquote>
<p>此时解决办法就是：需要⼀个模式去规范，到底哪个类该往哪⾥写。</p>
<h2 id="6-1-MVC设计模式"><a href="#6-1-MVC设计模式" class="headerlink" title="6.1 MVC设计模式"></a>6.1 MVC设计模式</h2><p>Web MVC中的M(model)-V(view)-C(controller)概念和标准MVC概念⼀样，我们再看⼀下Web MVC标准架构，如下图所示：</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210421201140.png" alt="image-20210421201133156"></p>
<p>在Web MVC模式下，模型⽆法主动推数据给视图，如果⽤户想要视图更新，需要再发送⼀次请求（即请求-响应模型）。</p>
<ul>
<li><p>M：(Model) 模型 : 应⽤程序的核⼼功能，管理这个模块中⽤的数据和值（bean,dao）</p>
<p>java基础部分的内省内容介绍了javabean的概念，以及如何通过内省的方式获取bean类中的get/set方法！</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">JavaBeans </span>:是<span class="keyword">Java中⼀种特殊的类（换⾔之：JavaBean就是⼀个Java类）.</span></span><br><span class="line"><span class="keyword">⼀个Java类 </span>，满⾜以下要求，则可称为⼀个<span class="keyword">JavaBean</span></span><br><span class="line"><span class="keyword">a. </span>public修饰的类，提供public ⽆参构造⽅法</span><br><span class="line"><span class="keyword">b. </span>所有属性 都是private</span><br><span class="line">C. 提供getter和setter⽅法</span><br><span class="line">从使⽤层⾯来看，<span class="keyword">JavaBean分为2⼤类：</span></span><br><span class="line"><span class="keyword">a. </span>封装业务逻辑的<span class="keyword">JavaBean(eg:LoginDao.java </span>封装了登录逻辑)</span><br><span class="line"><span class="keyword">b. </span>封装数据的<span class="keyword">JavaBean(实体类：eg：Student.java </span>Vadio.<span class="keyword">java </span>。往往对应于数据库中的⼀张</span><br><span class="line">表，即数据库中有个Student表，项⽬中就有个Student.<span class="keyword">java类)通常:表名=类名，列名=属性名</span></span><br><span class="line"><span class="keyword">JavaBean是⼀个可以重复使⽤的组件，通过编写⼀个组件来实现某种通⽤功能，“⼀次编写、任何地⽅执</span></span><br><span class="line"><span class="keyword">⾏、任何地⽅重⽤”</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>V(View )视图：视图提供模型的展示，管理模型如何显示给⽤户，它是应⽤程序的外观；（jsp/html）</p>
</li>
<li><p>C(Controller)控制器：对⽤户的输⼊做出反应，管理⽤户和视图的交互，是连接模型和视图的枢纽。（servlet/service）MVC⽤于将web（UI）层进⾏职责解耦</p>
<p>说明:mvc设计模式(不属于23种设计模式)</p>
</li>
</ul>
<h2 id="6-2-三层架构"><a href="#6-2-三层架构" class="headerlink" title="6.2 三层架构"></a>6.2 三层架构</h2><p>三层架构：</p>
<p>通常意义上的三层架构就是将整个业务应⽤划分为：表现层（UI）、业务逻辑层（BLL）、数据访问层（DAL）。区分层次的⽬的即为了“⾼内聚，低耦合”的思想。</p>
<ul>
<li>哪三层？<ul>
<li>表现层（UI）：通俗讲就是展现给⽤户的界⾯，即⽤户在使⽤⼀个系统的时候他的所⻅所得。<code>jsp/html</code></li>
<li>业务逻辑层（BLL）：针对具体问题的操作，也可以说是对数据层的操作，对数据业务逻辑处理。<code>servlet,service</code></li>
<li>数据访问层（DAL）：该层所做事务直接操作数据库，针对数据的增添、删除、修改、更新、查找等。<code>dao</code></li>
</ul>
</li>
<li>代表框架：<ul>
<li>表现层实现的代表作品是Struts,springmvc框架</li>
<li>业务层实现的代表作品是Spring</li>
<li>持久层实现的代表作品是Hibernate,mybatis</li>
</ul>
</li>
<li>层就相当于⼀个⿊盒⼦，我们不⽤知道它内部怎么实现，只需要知道如何去调⽤它就⾏了。每层只与上下相邻的两层打交道。当⼀层内部由于技术变迁发⽣变化时，只要接⼝不变，其他层不⽤做任何改变。分层之后灵活性提⾼，也便于团队分⼯开发。</li>
</ul>
<h2 id="6-3-三层架构和MVC的区别与联系"><a href="#6-3-三层架构和MVC的区别与联系" class="headerlink" title="6.3 三层架构和MVC的区别与联系"></a>6.3 三层架构和MVC的区别与联系</h2><p><img src="https://gitee.com/biongd/img/raw/master/img/20210421203306.png" alt="image-20210421203306582"></p>
<p>实例：</p>
<p>客户端发送请求&gt;servlet&gt;service&gt;dao&gt;数据库</p>
<h1 id="7-Ajax"><a href="#7-Ajax" class="headerlink" title="7. Ajax"></a>7. Ajax</h1><h2 id="7-1-Ajax简介"><a href="#7-1-Ajax简介" class="headerlink" title="7.1 Ajax简介"></a>7.1 Ajax简介</h2><p>AJAX = Asynchronous JavaScript and XML（异步的 JavaScript 和 XML）。</p>
<p>AJAX 不是新的编程语⾔，⽽是⼀种使⽤现有标准的新⽅法。</p>
<p>AJAX 是<strong>与服务器交换数据并更新部分⽹⻚</strong>的艺术，在不重新加载整个⻚⾯的情况下。</p>
<h2 id="7-2-Ajax所包含的技术"><a href="#7-2-Ajax所包含的技术" class="headerlink" title="7.2 Ajax所包含的技术"></a>7.2 Ajax所包含的技术</h2><p>ajax并⾮⼀种新的技术，⽽是⼏种原有技术的结合体。它由下列技术组合⽽成。</p>
<ol>
<li><p>使⽤CSS和XHTML来表示。</p>
</li>
<li><p>使⽤DOM模型来交互和动态显示。</p>
</li>
<li><p>使⽤XMLHttpRequest来和服务器进⾏异步通信。</p>
</li>
<li><p>使⽤javascript来绑定和调⽤。</p>
</li>
<li><p>AJAX 的核⼼是 XMLHttpRequest 对象。</p>
<p>不同的浏览器创建 XMLHttpRequest 对象的⽅法是有差异的。IE 浏览器使⽤ ActiveXObject，⽽其他的浏览器使⽤名为 XMLHttpRequest 的 JavaScript 内建对象</p>
</li>
</ol>
<h2 id="7-3-Ajax的工作原理"><a href="#7-3-Ajax的工作原理" class="headerlink" title="7.3 Ajax的工作原理"></a>7.3 Ajax的工作原理</h2><p>Ajax的⼯作原理相当于在⽤户和服务器之间加了—个中间层(AJAX引擎)，使⽤户操作与服务器响应异步化。并不是所有的⽤户请求都提交给服务器。像—些数据验证和数据处理等都交给Ajax引擎⾃⼰来做,，只有确定需要从服务器读取新数据时再由Ajax引擎代为向服务器提交请求。</p>
<ul>
<li><p>传统的web应用模型</p>
<p>UI&gt;&gt;HTTP请求&gt;&gt;web服务器&gt;&gt;数据存储和逻辑处理&gt;&gt;返回HTML和CSS数据</p>
</li>
<li><p>利用Ajax异步的web应用模型</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210423090919.png" alt="image-20210423090912818"></p>
<p>多了一个Ajax作为中介，客户端发送的是本地的js请求，再由浏览器转换为http请求发送到服务器</p>
<p>同时对于服务器的返回数据，也是由Ajax引擎转换到HTML</p>
</li>
<li><p>浏览器的普通交互方式</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210423091302.png" alt="image-20210423091302011" style="zoom:67%;" /></p>
</li>
<li><p>Ajax交互方式</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210423091325.png" alt="image-20210423091325507" style="zoom:67%;" /></p>
</li>
</ul>
<h3 id="异步的理解："><a href="#异步的理解：" class="headerlink" title="异步的理解："></a><strong>异步的理解：</strong></h3><p>浏览器调用JS调用Ajax引擎，向服务器发送html请求，服务器接收请求 并做出反应，向浏览器发送xml或文本数据,而不是整个html页面(我认为ajax引擎就是xmlhttprequest对象，通过xmlhttprequest向服务器发送请求) </p>
<p>Ajax是一种技术，而我认为实现该技术的核心是XmlHttpRequest，XmlHttpRequest（XMLHTTP是个传送XML格式数据的超文本传输协议）是XMLHTTP组件的对象，通过这个对象，浏览器就可向服务器请求并处理响应了（此通信是数据层面的交互），而不阻塞用户</p>
<hr>
<p>Ajax生成的XMLHttpRequest对象就像是将用户想要对服务器进行的请求暂时存储为XML数据，然后再向服务器提交，此时就可以实现多个响应的异步执行！！！！</p>
<ul>
<li>之前的提交请求后跳转（包括跳转会原页面）的方式：导致用户只能一次请求后就要等待</li>
<li>之前的前端js进行用户判断的方式：无法调用后台数据库的数据进行验证</li>
</ul>
<p><strong>实例：</strong></p>
<ul>
<li>在创建Web站点时，在客户端执⾏屏幕更新为⽤户提供了很⼤的灵活性。下⾯是使⽤Ajax可以完成的功能：</li>
<li>动态更新购物⻋的物品总数，⽆需⽤户单击Update并等待服务器重新发送整个⻚⾯。</li>
<li>提升站点的性能，这是通过减少从服务器下载的数据量⽽实现的。例如，在Amazon的购物⻋⻚⾯，当更新篮⼦中的⼀项物品的数量时，会重新载⼊整个⻚⾯，这必须下载32K的数据。如果使⽤Ajax计算新的总量，服务器只会返回新的总量值，因此所需的带宽仅为原来的百分之⼀。</li>
<li>消除了每次⽤户输⼊时的⻚⾯刷新。例如，在Ajax中，如果⽤户在分⻚列表上单击Next，则服务器数据只刷新列表⽽不是整个⻚⾯。</li>
<li>直接编辑表格数据，⽽不是要求⽤户导航到新的⻚⾯来编辑数据。对于Ajax，当⽤户单击Edit时，可以将静态表格刷新为内容可编辑的表格。⽤户单击Done之后，就可以发出⼀个Ajax请求来更新服务器，并刷新表格，使其包含静态、只读的数据。</li>
</ul>
<h2 id="7-4-XMLHttpRequest常⽤属性"><a href="#7-4-XMLHttpRequest常⽤属性" class="headerlink" title="7.4 XMLHttpRequest常⽤属性"></a>7.4 XMLHttpRequest常⽤属性</h2><ol>
<li><p>onreadystatechange 属性<br> onreadystatechange 属性存有处理服务器响应的函数。<br> 下⾯的代码定义⼀个空的函数，可同时对 onreadystatechange 属性进⾏设置：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlHttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">//我们需要在这写⼀些代码&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>readyState 属性<br>readyState 属性存有服务器响应的状态信息。每当 readyState 改变时，onreadystatechange 函数就会被执⾏。<br>readyState 属性可能的值：</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210423093323.png" alt="image-20210423093323545" style="zoom:67%;" /></p>
<p>我们要向这个 onreadystatechange 函数添加⼀条 If 语句，来测试我们的响应是否已完成(意味着可获得数据)：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xmlHttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (xmlHttp.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">    <span class="comment">//从服务器的response获得数据</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>responseText 属性<br> 可以通过 responseText 属性来取回由服务器返回的数据。<br> 在我们的代码中，我们将把时间⽂本框的值设置为等于 responseText：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xmlHttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (xmlHttp.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">    <span class="built_in">document</span>.myForm.time.value = xmlHttp.responseText;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其它属性如下：</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210423093517.png" alt="image-20210423093516948"></p>
</li>
</ol>
<h2 id="7-5-XMLHttpRequest⽅法"><a href="#7-5-XMLHttpRequest⽅法" class="headerlink" title="7.5 XMLHttpRequest⽅法"></a>7.5 XMLHttpRequest⽅法</h2><ol>
<li><p>open() ⽅法<br> open() 有三个参数。第⼀个参数定义发送请求所使⽤的⽅法，第⼆个参数规定服务器端脚本的URL，第三个参数规定应当对请求进⾏异步地处理。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlHttp.open(<span class="string">"GET"</span>,<span class="string">"test.php"</span>,<span class="literal">true</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>send() ⽅法<br> send() ⽅法将请求送往服务器。如果我们假设 HTML ⽂件和 PHP ⽂件位于相同的⽬录，那么代码是这<br> 样的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlHttp.send(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>其他方法如下：</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210423093620.png" alt="image-20210423093620695"></p>
</li>
</ol>
<h2 id="完整的Ajax动态响应实例"><a href="#完整的Ajax动态响应实例" class="headerlink" title="完整的Ajax动态响应实例"></a>完整的Ajax动态响应实例</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//发送异步请求</span></span><br><span class="line">    <span class="comment">//1.创建XMLHttpRequest</span></span><br><span class="line">    <span class="comment">//注意：⼀般我们⼿写AJAX的时候，⾸先要判断该浏览器是否⽀持XMLHttpRequest对象，如果⽀持则创建该对象，如果不⽀持则创建ActiveX对象(如果是IE5或者IE6浏览器，则使⽤ActiveX对象，创建⽅法是：)。</span></span><br><span class="line">    <span class="keyword">var</span> xmlhttp;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest)&#123;</span><br><span class="line">      <span class="comment">//非IE</span></span><br><span class="line">      xmlhttp = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">window</span>.ActiveXObject)&#123;</span><br><span class="line">      <span class="comment">//IE</span></span><br><span class="line">      xmlhttp = <span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.打开链接</span></span><br><span class="line">    <span class="keyword">var</span> uname = <span class="built_in">document</span>.getElementById(<span class="string">"uname"</span>).value;</span><br><span class="line">    xmlhttp.open(<span class="string">"get"</span>,<span class="string">"/testuname?username="</span>+uname, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">//3.指定回调函数</span></span><br><span class="line">    xmlhttp.onreadystatechange=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="comment">//3.1 判断状态</span></span><br><span class="line">      <span class="keyword">if</span>(xmlhttp.readyState==<span class="number">4</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> responseText = xmlhttp.responseText;</span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">"rs"</span>).innerText = responseText;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//4.发送数据</span></span><br><span class="line">    xmlhttp.send();</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="第二步：请求方法："><a href="#第二步：请求方法：" class="headerlink" title="第二步：请求方法："></a><strong>第二步：请求方法：</strong></h3><p>在WEB开发中，请求有两种形式，⼀个是get，⼀个是post，所以在这⾥需要设置⼀下具体使⽤哪个请求，XMLHttpRequest对象的open()⽅法就是来设置请求⽅式的。</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210423094532.png" alt="image-20210423094532847"></p>
<p>如将上面的get请求转为post请求：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//如何发送post请求</span></span><br><span class="line">xmlhttp.open(<span class="string">"post"</span>,<span class="string">"/testuname"</span>, <span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//如何传递get里面的参数, 在send方法中传</span></span><br><span class="line"> <span class="comment">//第四步：设置发送请求的内容和发送报送。然后发送请求</span></span><br><span class="line"><span class="keyword">var</span> params = <span class="string">"userName="</span> + uname；</span><br><span class="line"><span class="comment">// 增加time随机参数，防⽌读取缓存</span></span><br><span class="line">xmlHttp.setRequestHeader(<span class="string">"Content-type"</span>, <span class="string">"application/x-www-form-</span></span><br><span class="line"><span class="string">urlencoded;charset=UTF-8"</span>);</span><br><span class="line"><span class="comment">// 向请求添加 HTTP 头，POST如果有数据⼀定加加！！！！</span></span><br><span class="line">xmlHttp.send(params);</span><br></pre></td></tr></table></figure>
<p>异步 - True 或 False？<br>AJAX 指的是异步 JavaScript 和 XML（Asynchronous JavaScript and XML）。XMLHttpRequest 对象如果要⽤于 AJAX 的话，其 open() ⽅法的 async 参数必须设置为 true：对于 web 开发⼈员来说，发送异步请求是⼀个巨⼤的进步。很多在服务器执⾏的任务都相当费时。AJAX 出现之前，这可能会引起应⽤程序挂起或停⽌。通过 AJAX，JavaScript ⽆需等待服务器的响应，⽽是：</p>
<p>在等待服务器响应时执⾏其他脚本，当响应就绪后对响应进⾏处理</p>
<h3 id="第三步：调⽤回调函数"><a href="#第三步：调⽤回调函数" class="headerlink" title="第三步：调⽤回调函数"></a>第三步：调⽤回调函数</h3><p><strong>所谓回调函数，就是请求在后台处理完，再返回到前台所实现的功能。</strong></p>
<p>如果在上⼀步中open⽅法的第三个参数选择的是true，那么当前就是异步请求，这个时候需要写⼀个回调函数，XMLHttpRequest对象有⼀个onreadystatechange属性，这个属性返回的是⼀个匿名的⽅法，所以回调函数就在这⾥写xmlHttp.onreadystatechange=function{},function{}内部就是回调函数的内容。</p>
<p>在这个例⼦⾥，我们的回调函数要实现的功能就是接收后台处理后反馈给前台的数据，然后将这个数据显示到指定的div上。因为从<br>后台返回的数据可能是错误的，所以在回调函数中⾸先要判断后台返回的信息是否正确，如果正确才可以继续执⾏。代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第三步：注册回调函数</span></span><br><span class="line">xmlHttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (xmlHttp.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (xmlHttp.status == <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> obj = <span class="built_in">document</span>.getElementById(id);</span><br><span class="line">        obj.innerHTML = xmlHttp.responseText;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        alert(<span class="string">"AJAX服务器返回错误！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在上⾯代码中，<strong>xmlHttp.readyState是存有XMLHttpRequest 的状态</strong>。从 0 到 4 发⽣变化。0: 请求未初始化。1: 服务器连接已建⽴。2: 请求已接收。3: 请求处理中。4: 请求已完成，且响应已就绪。所以这⾥我们判断只有当xmlHttp.readyState为4的时候才可以继续执⾏。</p>
<p><strong>xmlHttp.status是服务器返回的结果</strong>，其中200代表正确。404代表未找到⻚⾯，所以这⾥我们判断只有当xmlHttp.status等于200的时候才可以继续执⾏。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">document</span>.getElementById(id);obj.innerHTML = xmlHttp.responseText;</span><br></pre></td></tr></table></figure>
<p>这段代码就是回调函数的核⼼内容，就是获取后台返回的数据，然后将这个数据赋值给id为testid的div。xmlHttp对象有两个属性都可以获取后台返回的数据，分别是：responseText和responseXML，其中responseText是⽤来获得字符串形式的响应数据，responseXML是⽤来获得 XML 形式的响应数据。⾄于选择哪⼀个是取决于后台给返回的数据的，这个例⼦⾥我们只是显示⼀条字符串数据所以选择<br>的是responseText。responseXML将会在以后的例⼦中介绍。</p>
<h3 id="AJAX状态值与状态码区别"><a href="#AJAX状态值与状态码区别" class="headerlink" title="AJAX状态值与状态码区别"></a>AJAX状态值与状态码区别</h3><p>AJAX状态值是指，运⾏AJAX所经历过的⼏种状态，⽆论访问是否成功都将响应的步骤，可以理解成为AJAX运⾏步骤。如：正在发送，正在响应等，由AJAX对象与服务器交互时所得；使⽤“ajax.readyState”获得。（由数字1~4单位数字组成）</p>
<p>AJAX状态码是指，⽆论AJAX访问是否成功，由HTTP协议根据所提交的信息，服务器所返回的HTTP头信息代码，该信息使⽤“ajax.status”所获得；（由数字1XX,2XX三位数字组成，详细查看RFC）这就是我们在使⽤AJAX时为什么采⽤下⾯的⽅式判断所获得的信息是否正确的原因。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(ajax.readyState == <span class="number">4</span> &amp;&amp; ajax.status == <span class="number">200</span>) &#123;。。。。);&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>AJAX运⾏步骤与状态值说明:</p>
<p>在AJAX实际运⾏当中，对于访问XMLHttpRequest（XHR）时并不是⼀次完成的，⽽是分别经历了多种状态后取得的结果，对于这种状态在AJAX中共有5种，分别是：</p>
<p>0 - (未初始化)还没有调⽤send()⽅法<br>1 - (载⼊)已调⽤send()⽅法，正在发送请求<br>2 - (载⼊完成)send()⽅法执⾏完成，<br>3 - (交互)正在解析响应内容<br>4 - (完成)响应内容解析完成，可以在客户端调⽤了</p>
<p>对于上⾯的状态，其中“0”状态是在定义后⾃动具有的状态值，⽽对于成功访问的状态（得到信息）我们⼤多数采⽤“4”进⾏判断。<br>AJAX状态码分为5类<br>1：请求收到，继续处理<br>2：操作成功收到，分析、接受<br>3：完成此请求必须进⼀步处理<br>4：请求包含⼀个错误语法或不能完成<br>5：服务器执⾏⼀个完全有效请求失败</p>
<p>再具体就如下：<br>100——客户必须继续发出请求<br>101——客户要求服务器根据请求转换HTTP协议版本<br>200——交易成功<br>201——提示知道新⽂件的URL<br>202——接受和处理、但处理未完成<br>203——返回信息不确定或不完整<br>204——请求收到，但返回信息为空<br>205——服务器完成了请求，⽤户代理必须复位当前已经浏览过的⽂件<br>206——服务器已经完成了部分⽤户的GET请求<br>300——请求的资源可在多处得到<br>301——删除请求数据<br>302——在其他地址发现了请求数据<br>303——建议客户访问其他URL或访问⽅式<br>304——客户端已经执⾏了GET，但⽂件未变化<br>305——请求的资源必须从服务器指定的地址得到<br>306——前⼀版本HTTP中使⽤的代码，现⾏版本中不再使⽤<br>307——申明请求的资源临时性删除<br>400——错误请求，如语法错误<br>401——请求授权失败<br>402——保留有效ChargeTo头响应<br>403——请求不允许<br>404——没有发现⽂件、查询或URl<br>405——⽤户在Request-Line字段定义的⽅法不允许<br>406——根据⽤户发送的Accept拖，请求资源不可访问<br>407——类似401，⽤户必须⾸先在代理服务器上得到授权<br>408——客户端没有在⽤户指定的饿时间内完成请求<br>409——对当前资源状态，请求不能完成<br>410——服务器上不再有此资源且⽆进⼀步的参考地址</p>
<p>411——服务器拒绝⽤户定义的Content-Length属性请求<br>412——⼀个或多个请求头字段在当前请求中错误<br>413——请求的资源⼤于服务器允许的⼤⼩<br>414——请求的资源URL⻓于服务器允许的⻓度<br>415——请求资源不⽀持请求项⽬格式<br>416——请求中包含Range请求头字段，在当前请求资源范围内没有range指示值，请求也不包含If-Range请求头字段<br>417——服务器不满⾜请求Expect头字段指定的期望值，如果是代理服务器，可能是下⼀级服务器不能满⾜请求<br>500——服务器产⽣内部错误<br>501——服务器不⽀持请求的函数<br>502——服务器暂时不可⽤，有时是为了防⽌发⽣系统过载<br>503——服务器过载或暂停维修<br>504——关⼝过载，服务器使⽤另⼀个关⼝或服务来响应⽤户，等待时间设定值较⻓<br>505——服务器不⽀持或拒绝⽀请求头中指定的HTTP版本</p>
</li>
</ul>
<h2 id="7-6-jquery的ajax操作"><a href="#7-6-jquery的ajax操作" class="headerlink" title="7.6 jquery的ajax操作"></a>7.6 jquery的ajax操作</h2><h3 id="7-6-1-ajax-⽅法"><a href="#7-6-1-ajax-⽅法" class="headerlink" title="7.6.1 ajax()⽅法"></a>7.6.1 ajax()⽅法</h3><p>可以通过发送 HTTP请求加载远程数据，是 jQuery 最底层的 Ajax 实现，具有较⾼灵活性。<br><code>$.ajax( [settings] );</code> </p>
<p>参数 settings 是$.ajax ( )⽅法的参数列表，⽤于配置 Ajax 请求的键值对集合;</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    url:请求地址,</span><br><span class="line">    type:<span class="string">"get | post | put | delete "</span> 默认是<span class="keyword">get</span>,</span><br><span class="line">    data:请求参数 &#123;<span class="string">"id"</span>:<span class="string">"123"</span>,<span class="string">"pwd"</span>:<span class="string">"123456"</span>&#125;,</span><br><span class="line">    dataType:请求数据类型<span class="string">"html | text | json | xml | script | jsonp "</span>,</span><br><span class="line">    success:<span class="function"><span class="keyword">function</span>(<span class="params">data,dataTextStatus,jqxhr</span>)</span>&#123; &#125;,<span class="comment">//请求成功时</span></span><br><span class="line">    error:<span class="function"><span class="keyword">function</span>(<span class="params">jqxhr,textStatus,error</span>)//请求失败时</span></span><br><span class="line"><span class="function">&#125;)</span></span><br></pre></td></tr></table></figure>
<h3 id="7-6-2-get-方法"><a href="#7-6-2-get-方法" class="headerlink" title="7.6.2 get() 方法"></a>7.6.2 get() 方法</h3><p>通过远程 HTTP GET 请求载⼊信息。这是⼀个简单的 GET 请求功能以取代复杂 $.ajax 。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="keyword">get</span>(url,data,function(result) &#123;</span><br><span class="line">	<span class="comment">//省略将服务器返回的数据显示到⻚⾯的代码</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>url:请求的路径<br>data:发送的数据<br>success:成功函数<br>datatype 返回的数据</p>
<h3 id="7-6-3-post-方法"><a href="#7-6-3-post-方法" class="headerlink" title="7.6.3 post() 方法"></a>7.6.3 post() 方法</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$.post(url,data,<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">	<span class="comment">//省略将服务器返回的数据显示到⻚⾯的代码</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>url:请求的路径<br>data:发送的数据<br>success:成功函数<br>datatype 返回的数据</p>
<h1 id="8-JSON"><a href="#8-JSON" class="headerlink" title="8. JSON"></a>8. JSON</h1><blockquote>
<p>java基础中的json内容：第11章</p>
</blockquote>
<p>JSON (JavaScript Object Notation) 是⼀种轻量级的数据交换格式。 易于⼈阅读和编写。同时也易于机器解析和⽣成。 它基于JavaScript Programming Language, Standard ECMA-262 3rd Edition -December 1999的⼀个⼦集。 JSON采⽤完全独⽴于语⾔的⽂本格式，但是也使⽤了类似于C语⾔家族的习惯（包括C, C++, C#, Java, JavaScript, Perl, Python等）。 这些特性使JSON成为理想的数据交换语⾔。</p>
<h2 id="8-1-JSON对象定义和使用"><a href="#8-1-JSON对象定义和使用" class="headerlink" title="8.1 JSON对象定义和使用"></a>8.1 JSON对象定义和使用</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 变量名 = &#123;</span><br><span class="line">    “key” : value , <span class="comment">// Number类型</span></span><br><span class="line">    “key2” : “value” , <span class="comment">// 字符串类型</span></span><br><span class="line">    “key3” : [] , <span class="comment">// 数组类型</span></span><br><span class="line">    “key4” : &#123;&#125;, <span class="comment">// json 对象类型</span></span><br><span class="line">    “key5” : [&#123;&#125;,&#123;&#125;] <span class="comment">// json 数组</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>JSON对象的访问：</p>
<p>json对象，顾名思义，就知道它是⼀个对象。⾥⾯的key就是对象的属性。我们要访问⼀个对象的属性，只需要使⽤[对象名.属性名]的⽅式访问即可。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line"><span class="comment">// json的定义</span></span><br><span class="line"><span class="keyword">var</span> jsons = &#123;</span><br><span class="line">    <span class="string">"key1"</span>:<span class="string">"abc"</span>, <span class="comment">// 字符串类型</span></span><br><span class="line">    <span class="string">"key2"</span>:<span class="number">1234</span>, <span class="comment">// Number</span></span><br><span class="line">    <span class="string">"key3"</span>:[<span class="number">1234</span>,<span class="string">"21341"</span>,<span class="string">"53"</span>], <span class="comment">// 数组</span></span><br><span class="line">    <span class="string">"key4"</span>:&#123; <span class="comment">// json类型</span></span><br><span class="line">        <span class="string">"key4_1"</span> : <span class="number">12</span>,</span><br><span class="line">        <span class="string">"key4_2"</span> : <span class="string">"kkk"</span></span><br><span class="line">    	&#125;,</span><br><span class="line">    <span class="string">"key5"</span>:[&#123; <span class="comment">// json数组</span></span><br><span class="line">        <span class="string">"key5_1_1"</span> : <span class="number">12</span>,</span><br><span class="line">        <span class="string">"key5_1_2"</span> : <span class="string">"abc"</span></span><br><span class="line">        &#125;,&#123;</span><br><span class="line">        <span class="string">"key5_2_1"</span> : <span class="number">41</span>,</span><br><span class="line">        <span class="string">"key5_2_2"</span> : <span class="string">"bbj"</span></span><br><span class="line">    	&#125;]</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 访问json的属性</span></span><br><span class="line">alert(jsons.key1); <span class="comment">// "abc"</span></span><br><span class="line"><span class="comment">// 访问json的数组属性</span></span><br><span class="line">alert(jsons.key3[<span class="number">1</span>]); <span class="comment">// "21341"</span></span><br><span class="line"><span class="comment">// 访问json的json属性</span></span><br><span class="line">alert(jsons.key4.key4_1);<span class="comment">//12</span></span><br><span class="line"><span class="comment">// 访问json的json数组</span></span><br><span class="line">alert(jsons.key5[<span class="number">0</span>].key5_1_2);<span class="comment">//"abc"</span></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="8-2-JSON在java中的使⽤-重要"><a href="#8-2-JSON在java中的使⽤-重要" class="headerlink" title="8.2 JSON在java中的使⽤(重要)"></a>8.2 JSON在java中的使⽤(重要)</h2><p>我们要使⽤json和java中使⽤，我们需要使⽤到⼀个第三⽅的包。它就是</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210424132756.png" alt="image-20210424132756139"></p>
<p>java对象和json之间的转换</p>
<ul>
<li><p>单个对象或map集合<br>java-&gt;json：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Users user2=<span class="keyword">new</span> Users();</span><br><span class="line">user2.setUsername(<span class="string">"李四"</span>);</span><br><span class="line">user2.setPassword(<span class="string">"abc"</span>);</span><br><span class="line">user2.setAge(<span class="number">20</span>);</span><br><span class="line">JSONObject obj=JSONObject.fromObject(user);<span class="comment">//obj就是json格式的</span></span><br></pre></td></tr></table></figure>
<p>json-&gt;java：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String str=<span class="string">"&#123;'username':'李四','password':'admin','age':19&#125;"</span>;</span><br><span class="line">JSONObject json=JSONObject.fromObject(str);</span><br><span class="line">Users user=(Users)JSONObject.toBean(json,Users<span class="class">.<span class="keyword">class</span>)</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>对象集合和json的转换</p>
<p>java集合-&gt;json数组</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List list=<span class="keyword">new</span> ArrayList();</span><br><span class="line">list.add(<span class="string">"dd"</span>);</span><br><span class="line">list.add(<span class="string">"aa"</span>);</span><br><span class="line">JSONArray obj=JSONArray.fromObject(list);<span class="comment">//set也是这么转</span></span><br></pre></td></tr></table></figure>
<p>json数组-&gt;java数组</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String str2=<span class="string">"[&#123;'age':20,'password':'abc','username':'李四'&#125;,</span></span><br><span class="line"><span class="string">&#123;'age':10,'password':'adb','username':'张三'&#125;]"</span>;</span><br><span class="line">JSONArray json2=JSONArray.fromObject(str2);</span><br><span class="line">Object[] obj=(Object[])JSONArray.toArray(json2,Users<span class="class">.<span class="keyword">class</span>)</span>;</span><br></pre></td></tr></table></figure>
<p>json数组-&gt;java集合</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String str3=<span class="string">"[&#123;'age':20,'password':'abc','username':'李四'&#125;,</span></span><br><span class="line"><span class="string">&#123;'age':10,'password':'adb','username':'展示⼲'&#125;]"</span>;</span><br><span class="line">JSONArray json3=JSONArray.fromObject(str3);</span><br><span class="line"><span class="comment">//默认转换成ArrayList</span></span><br><span class="line">List&lt;Users&gt; list=(List&lt;Users&gt;) JSONArray.toCollection(json3,Users<span class="class">.<span class="keyword">class</span>)</span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="Ajax和json总结"><a href="#Ajax和json总结" class="headerlink" title="Ajax和json总结"></a>Ajax和json总结</h1><p><strong>配合实现用户检测和信息填充</strong></p>
<p>在MVC作业中，实现了将数据库信息作为表格呈现在jsp中</p>
<p>在此基础上，将Ajax实现页面的局部刷新（非跳转刷新），同时用json格式替换xml格式作为数据的传输格式</p>
<h2 id="bean层"><a href="#bean层" class="headerlink" title="bean层"></a>bean层</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Student&#123;</span><br><span class="line">    stuid;stuname;age;sex;</span><br><span class="line">    <span class="comment">//有参构造；</span></span><br><span class="line">    <span class="comment">//无参构造；</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="dao层"><a href="#dao层" class="headerlink" title="dao层"></a>dao层</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接口：</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义操作数据库的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Student&gt; <span class="title">getall</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">findByName</span><span class="params">(String name)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//实现类：</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentDaoImpl</span> <span class="keyword">extends</span> <span class="title">DruidUtil</span> <span class="keyword">implements</span> <span class="title">StudentDao</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//MVC获取数据库全部信息</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Student&gt; <span class="title">getall</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List list=<span class="keyword">new</span> ArrayList();</span><br><span class="line">        Connection connection =<span class="keyword">null</span>;</span><br><span class="line">        PreparedStatement preparedStatement=<span class="keyword">null</span>;</span><br><span class="line">        ResultSet resultSet=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">             connection = getConnection();</span><br><span class="line">             preparedStatement = connection.prepareStatement(<span class="string">"select * from student"</span>);</span><br><span class="line">             resultSet = preparedStatement.executeQuery();</span><br><span class="line">            <span class="keyword">while</span>(resultSet.next())&#123;</span><br><span class="line">                Student student = <span class="keyword">new</span> Student();</span><br><span class="line">                student.setStuid(resultSet.getInt(<span class="string">"stuid"</span>));</span><br><span class="line">                student.setStuname(resultSet.getString(<span class="string">"stuname"</span>));</span><br><span class="line">                student.setAge(resultSet.getInt(<span class="string">"age"</span>));</span><br><span class="line">                student.setSex(resultSet.getInt(<span class="string">"sex"</span>));</span><br><span class="line">                list.add(student);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            close(connection,preparedStatement,resultSet);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获取响应用户名的信息</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">findByName</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"StudentDaoImpl执行"</span>);</span><br><span class="line">        Student student = <span class="keyword">new</span> Student();</span><br><span class="line">        Connection connection =<span class="keyword">null</span>;</span><br><span class="line">        PreparedStatement preparedStatement=<span class="keyword">null</span>;</span><br><span class="line">        ResultSet resultSet=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = getConnection();</span><br><span class="line">            preparedStatement = connection.prepareStatement(<span class="string">"select * from student where stuname=?"</span>);</span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>,name);</span><br><span class="line">            resultSet = preparedStatement.executeQuery();</span><br><span class="line">            <span class="keyword">while</span>(resultSet.next())&#123;</span><br><span class="line">                student.setStuid(resultSet.getInt(<span class="string">"stuid"</span>));</span><br><span class="line">                student.setStuname(resultSet.getString(<span class="string">"stuname"</span>));</span><br><span class="line">                student.setAge(resultSet.getInt(<span class="string">"age"</span>));</span><br><span class="line">                student.setSex(resultSet.getInt(<span class="string">"sex"</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            close(connection,preparedStatement,resultSet);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> student;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="service层"><a href="#service层" class="headerlink" title="service层"></a>service层</h2><p>接收沟通数据库的dao层的结果，交给沟通前端的servlet层</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//查询全部</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Student&gt; <span class="title">getall</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">findByName</span><span class="params">(String name)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//实现类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentServiceImpl</span> <span class="keyword">implements</span> <span class="title">StudentService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> StudentDao studentDao=<span class="keyword">new</span> StudentDaoImpl();</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Student&gt; <span class="title">getall</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> studentDao.getall();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">findByName</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"StudentServiceImpl执行"</span>);</span><br><span class="line">        <span class="keyword">return</span> studentDao.findByName(name);&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="servlet层"><a href="#servlet层" class="headerlink" title="servlet层"></a>servlet层</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet</span>(urlPatterns = <span class="string">"/login"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        doPost(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        String stuname = req.getParameter(<span class="string">"stuname"</span>);</span><br><span class="line">        StudentServiceImpl studentService = <span class="keyword">new</span> StudentServiceImpl();</span><br><span class="line">        Student student = studentService.findByName(stuname);</span><br><span class="line">        resp.setContentType(<span class="string">"text/html;charset=utf-8"</span>);</span><br><span class="line">        PrintWriter writer = resp.getWriter();</span><br><span class="line"><span class="comment">//        Ajax中的dataType为“JSON”，响应信息的格式就必须为JSON</span></span><br><span class="line">        <span class="keyword">if</span>(student.getAge()==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="comment">//将需要的内容改为JSON格式的字符串，然后再转为JSON</span></span><br><span class="line">            String a = <span class="string">"&#123;\"stuname\":\"notexist\"&#125;"</span>;</span><br><span class="line">            JSONObject jsonObject = JSONObject.fromObject(a);</span><br><span class="line">            writer.println(jsonObject);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            JSONObject jsonObject = JSONObject.fromObject(student);</span><br><span class="line">            writer.print(jsonObject);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="前端页面"><a href="#前端页面" class="headerlink" title="前端页面"></a>前端页面</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;$Title$&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt;</span><br><span class="line">  &lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">    $(function()&#123;</span><br><span class="line">      $(<span class="string">"#stuname"</span>).blur(function()&#123;</span><br><span class="line">        <span class="keyword">var</span> name = $(<span class="keyword">this</span>).val();</span><br><span class="line">        <span class="comment">//jquery实现Ajax</span></span><br><span class="line">        $.post(<span class="string">"/login"</span>,<span class="string">"stuname="</span>+name,function(rs)&#123;</span><br><span class="line">          <span class="comment">//转换成可以处理的js！！！！</span></span><br><span class="line">          rs=eval(<span class="string">"("</span>+rs+<span class="string">")"</span>);</span><br><span class="line">          <span class="comment">//字符串是否相同的判断！！！！</span></span><br><span class="line">          <span class="keyword">if</span>(<span class="string">"notexist"</span>===rs.stuname)&#123;</span><br><span class="line">            $(<span class="string">"#rs"</span>).html(rs.stuname);</span><br><span class="line">          &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $(<span class="string">"#stuname"</span>).val(rs.stuname);</span><br><span class="line">            $(<span class="string">"#age"</span>).val(rs.age);</span><br><span class="line">            $(<span class="string">"#sex"</span>).val(rs.sex===<span class="number">1</span>?<span class="string">'男'</span>:<span class="string">'女'</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">//此时的rs是json格式的对象</span></span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;a href="getstus"&gt;查询学生列表&lt;/a&gt;&lt;br&gt;</span><br><span class="line">  用户名：&lt;input type="text" id="stuname"&gt;&lt;span id="rs"&gt;&lt;/span&gt;&lt;br&gt;</span><br><span class="line">  年龄：&lt;input type=<span class="string">"text"</span> id=<span class="string">"age"</span>&gt;&lt;br&gt;</span><br><span class="line">  性别：&lt;input type=<span class="string">"text"</span> id=<span class="string">"sex"</span>&gt;&lt;br&gt;</span><br><span class="line">  &lt;button&gt;注册&lt;/button&gt;</span><br><span class="line">  &lt;button&gt;登录&lt;/button&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h1 id="9-文件的上传的下载"><a href="#9-文件的上传的下载" class="headerlink" title="9. 文件的上传的下载"></a>9. 文件的上传的下载</h1><ol>
<li><p>将jar包添加到项目中:smartupload.jar</p>
</li>
<li><p>准备上传的页面</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">"toUpload"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span> &gt;</span><br><span class="line">书名:&lt;input type=<span class="string">"text"</span> name=<span class="string">"bookName"</span>/&gt;&lt;br&gt;</span><br><span class="line">图片:&lt;input type=<span class="string">"file"</span> name=<span class="string">"自定义名称"</span>/&gt;&lt;br&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> value=<span class="string">"提交"</span>/&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<p><font color="red"><strong>注意</strong></font>：</p>
<ul>
<li>form标签中要添加enctype属性</li>
<li>提交方式必须是post</li>
</ul>
</li>
<li><p>开始获取数据,保存文件(上传)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet</span>(urlPatterns = <span class="string">"/uploadtest"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpLoadServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        doPost(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1.创建上传文件的对象</span></span><br><span class="line">            SmartUpload smartUpLoad = <span class="keyword">new</span> SmartUpload();</span><br><span class="line">            <span class="comment">//2.获得pageContext对象，初始化上传操作</span></span><br><span class="line">            JspFactory factory=JspFactory.getDefaultFactory();</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * 参数1：servlet对象</span></span><br><span class="line"><span class="comment">             * 参数2:、3：request和response对象</span></span><br><span class="line"><span class="comment">             * 参数4：字符串，指定跳转失败的页面</span></span><br><span class="line"><span class="comment">             * 参数5：是否使用session</span></span><br><span class="line"><span class="comment">             * 参数6：缓冲区，单位字节</span></span><br><span class="line"><span class="comment">             * 参数7：缓冲区满了是否自动添加到输出流</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            PageContext pagecontext=factory.getPageContext(<span class="keyword">this</span>, req,resp,<span class="keyword">null</span>,<span class="keyword">false</span>,<span class="number">1024</span>,<span class="keyword">true</span>);</span><br><span class="line">            smartUpLoad.initialize(pagecontext);</span><br><span class="line">            <span class="comment">//3 设置编码</span></span><br><span class="line">            smartUpLoad.setCharset(<span class="string">"utf-8"</span>);</span><br><span class="line">            <span class="comment">//4 上传</span></span><br><span class="line">            smartUpLoad.upload();</span><br><span class="line">            <span class="comment">//4-1此时如果表单中有其他数据时，不能通过request直接获取，需要通过SmartUpload对象获取</span></span><br><span class="line">            <span class="comment">//并且该代码要在SmartUpload操作完成后添加</span></span><br><span class="line">            String name=smartUpLoad.getRequest().getParameter(<span class="string">"uname"</span>);</span><br><span class="line">            System.out.println(<span class="string">"uname="</span>+name);</span><br><span class="line">            <span class="comment">//4-2通过上传服务器的方式得到文件的基本信息</span></span><br><span class="line">            File file = smartUpLoad.getFiles().getFile(<span class="number">0</span>);</span><br><span class="line">            String filename=file.getFileName();</span><br><span class="line">            String type=file.getContentType();</span><br><span class="line">            System.out.println(<span class="string">"type="</span>+type);</span><br><span class="line">            <span class="comment">//指定上传路径</span></span><br><span class="line">            String upLoadPath=<span class="string">"/uploadfiles/"</span>+filename;</span><br><span class="line">            <span class="comment">//保存到指定位置</span></span><br><span class="line">            file.saveAs(upLoadPath,File.SAVEAS_VIRTUAL);</span><br><span class="line">            <span class="comment">//跳转到成功页面</span></span><br><span class="line">            req.setAttribute(<span class="string">"filename"</span>,filename);</span><br><span class="line">            req.getRequestDispatcher(<span class="string">"success.jsp"</span>).forward(req,resp);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SmartUploadException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<font color="red">**注意：斜杠方向:/**</font>
</li>
<li><p>下载</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    String filename = req.getParameter(<span class="string">"filename"</span>);</span><br><span class="line">    String path = <span class="string">"/uploadfiles/"</span>+filename;</span><br><span class="line">    <span class="comment">//设置响应的头信息和响应类型</span></span><br><span class="line">    resp.setContentType(<span class="string">"application/octet-stream"</span>);</span><br><span class="line">    <span class="comment">//attachment 告诉浏览器以附件的方式下载文件(弹出下载框)</span></span><br><span class="line">    filename= URLEncoder.encode(filename,<span class="string">"utf-8"</span>);</span><br><span class="line">    resp.addHeader(<span class="string">"Content-Disposition"</span>,<span class="string">"attachment;filename="</span>+filename);</span><br><span class="line">    <span class="comment">//跳转页面</span></span><br><span class="line">    req.getRequestDispatcher(path).forward(req,resp);</span><br><span class="line">    <span class="comment">//清空缓冲区:将服务端缓冲区的文件内容,立即权并不传送给客户端</span></span><br><span class="line">    resp.flushBuffer();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><code>PageContext pagecontext=factory.getPageContext(this, req,resp,null,false,1024,true);</code>中各参数的含义</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210424234756.png" alt="image-20210424234755898" style="zoom:67%;" /></p>
<p>常用方法：</p>
<p><img src="https://gitee.com/biongd/img/raw/master/img/20210424234852.png" alt="image-20210424234852274"></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/java/" rel="tag"># java</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/04/14/java-%E5%89%8D%E7%AB%AF/" rel="next" title="java-前端">
                <i class="fa fa-chevron-left"></i> java-前端
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/04/25/%E8%AE%BA%E6%96%87-%E6%A1%86%E6%9E%B6/" rel="prev" title="论文-框架">
                论文-框架 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="xujunjie'blog" />
            
              <p class="site-author-name" itemprop="name">xujunjie'blog</p>
              <p class="site-description motion-element" itemprop="description">使一个人有限的生命更加有效也即等于延长了人的生命</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">78</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">33</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-web服务器及tomcat"><span class="nav-text">1. web服务器及tomcat</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-web服务器的概念"><span class="nav-text">1.1 web服务器的概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#两种开发模型"><span class="nav-text">两种开发模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web服务器分类"><span class="nav-text">web服务器分类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-tomcat"><span class="nav-text">1.2 tomcat</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-1-Tomcat下载与安装"><span class="nav-text">1.2.1 Tomcat下载与安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注意：8080端口占用问题！！！"><span class="nav-text">注意：8080端口占用问题！！！</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-2-tomcat的目录"><span class="nav-text">1.2.2 tomcat的目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-3-IntelliJ-IDEA配置Tomcat"><span class="nav-text">1.2.3 IntelliJ IDEA配置Tomcat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#创建java-web项目"><span class="nav-text">创建java-web项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#对该项目加些配置"><span class="nav-text">对该项目加些配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#将本地项目部署到服务器中"><span class="nav-text">将本地项目部署到服务器中</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-4-修改端口号"><span class="nav-text">1.2.4 修改端口号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-5-tomcat如何管理项目"><span class="nav-text">1.2.5 tomcat如何管理项目</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-Servlet"><span class="nav-text">2. Servlet</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-Servlet工作原理"><span class="nav-text">2.1 Servlet工作原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-1-Servlet-API"><span class="nav-text">2.1.1  Servlet API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-2-工作原理"><span class="nav-text">2.1.2 工作原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-3-Servlet的生命周期"><span class="nav-text">2.1.3 Servlet的生命周期</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-请求"><span class="nav-text">2.2 请求</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-1-常用方法"><span class="nav-text">2.2.1 常用方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-2-客户端如何发送数据给服务器"><span class="nav-text">2.2.2 客户端如何发送数据给服务器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-3-处理请求乱码的问题"><span class="nav-text">2.2.3 处理请求乱码的问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-4-get和post请求的区别"><span class="nav-text">2.2.4 get和post请求的区别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-响应"><span class="nav-text">2.3 响应</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-1-转发和重定向"><span class="nav-text">2.3.1 转发和重定向</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-session会话"><span class="nav-text">2.4 session会话</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5-获得初始化参数"><span class="nav-text">2.5 获得初始化参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-6-servlet3-0"><span class="nav-text">2.6 servlet3.0</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-JSP"><span class="nav-text">3. JSP</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-概念"><span class="nav-text">3.1 概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是JSP？"><span class="nav-text">什么是JSP？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSP为什么会出现"><span class="nav-text">JSP为什么会出现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSP中如何嵌套java代码"><span class="nav-text">JSP中如何嵌套java代码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-JSP的原理"><span class="nav-text">3.2  JSP的原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-JSP内置对象"><span class="nav-text">3.3 JSP内置对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#request，session，application，pageContext四种数据存储对象的区别："><span class="nav-text">request，session，application，pageContext四种数据存储对象的区别：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-JSP的指令"><span class="nav-text">3.4 JSP的指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-1-Page指令"><span class="nav-text">3.4.1 Page指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-2-include指令"><span class="nav-text">3.4.2 include指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-3-Taglib指令"><span class="nav-text">3.4.3 Taglib指令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-JSP出现的状态码"><span class="nav-text">3.5 JSP出现的状态码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-6-EL表达式"><span class="nav-text">3.6 EL表达式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-7-JSTL"><span class="nav-text">3.7 JSTL</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-session和cookie"><span class="nav-text">4. session和cookie</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-cookie"><span class="nav-text">4.1 cookie</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概念"><span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookie的应⽤"><span class="nav-text">Cookie的应⽤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookie的设置和获取"><span class="nav-text">Cookie的设置和获取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除Cookie"><span class="nav-text">删除Cookie</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-session"><span class="nav-text">4.2 session</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概念-1"><span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建Session的格式"><span class="nav-text">创建Session的格式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Session的⽣命周期"><span class="nav-text">Session的⽣命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常用方法"><span class="nav-text">常用方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Session和Cookie的区别"><span class="nav-text">Session和Cookie的区别</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-过滤器-Filter-和监听器（Listener）"><span class="nav-text">5. 过滤器(Filter)和监听器（Listener）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-Filter"><span class="nav-text">5.1 Filter</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概念-2"><span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#过滤器的语法格式："><span class="nav-text">过滤器的语法格式：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#过滤器的使用场合"><span class="nav-text">过滤器的使用场合</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-Listener"><span class="nav-text">5.2 Listener</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概念-3"><span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#监听三⼤域对象的创建与销毁的监听器"><span class="nav-text">监听三⼤域对象的创建与销毁的监听器</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-MVC"><span class="nav-text">6. MVC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-MVC设计模式"><span class="nav-text">6.1 MVC设计模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-三层架构"><span class="nav-text">6.2 三层架构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-3-三层架构和MVC的区别与联系"><span class="nav-text">6.3 三层架构和MVC的区别与联系</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-Ajax"><span class="nav-text">7. Ajax</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-Ajax简介"><span class="nav-text">7.1 Ajax简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-2-Ajax所包含的技术"><span class="nav-text">7.2 Ajax所包含的技术</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-3-Ajax的工作原理"><span class="nav-text">7.3 Ajax的工作原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#异步的理解："><span class="nav-text">异步的理解：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-4-XMLHttpRequest常⽤属性"><span class="nav-text">7.4 XMLHttpRequest常⽤属性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-5-XMLHttpRequest⽅法"><span class="nav-text">7.5 XMLHttpRequest⽅法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#完整的Ajax动态响应实例"><span class="nav-text">完整的Ajax动态响应实例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#第二步：请求方法："><span class="nav-text">第二步：请求方法：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第三步：调⽤回调函数"><span class="nav-text">第三步：调⽤回调函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AJAX状态值与状态码区别"><span class="nav-text">AJAX状态值与状态码区别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-6-jquery的ajax操作"><span class="nav-text">7.6 jquery的ajax操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-6-1-ajax-⽅法"><span class="nav-text">7.6.1 ajax()⽅法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-6-2-get-方法"><span class="nav-text">7.6.2 get() 方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-6-3-post-方法"><span class="nav-text">7.6.3 post() 方法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-JSON"><span class="nav-text">8. JSON</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#8-1-JSON对象定义和使用"><span class="nav-text">8.1 JSON对象定义和使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-2-JSON在java中的使⽤-重要"><span class="nav-text">8.2 JSON在java中的使⽤(重要)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Ajax和json总结"><span class="nav-text">Ajax和json总结</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#bean层"><span class="nav-text">bean层</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dao层"><span class="nav-text">dao层</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#service层"><span class="nav-text">service层</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#servlet层"><span class="nav-text">servlet层</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#前端页面"><span class="nav-text">前端页面</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-文件的上传的下载"><span class="nav-text">9. 文件的上传的下载</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xujunjie'blog</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>


  
  <script src='https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js'></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize("");
    }
  </script>


  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "./public/search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  


  

  

</body>
</html>
